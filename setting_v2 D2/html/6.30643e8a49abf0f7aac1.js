(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"4NyT":function(t,e,n){"use strict";n.r(e),n.d(e,"ManageModule",function(){return Ge});var i=n("ADsi"),c=n("tyNb"),s=n("mrSG"),o=n("cgZG"),a=n("mkZv"),r=n("YMfE"),l=n("Gu0I"),p=n("1G5W"),h=n("XNiG"),d=n("fXoL"),b=n("0IaG"),u=n("dNgK"),g=n("gZGI"),m=n("8SIa"),f=n("WTUP"),S=n("7dP1"),v=n("+Tj5"),O=n("jMnz"),C=n("tk/3");let y=(()=>{class t{constructor(t,e){this.api=t,this.http=e}getDeviceName(t){const e=Object.assign(Object.assign({},a.p.info.read),{session:t});return this.http.post(this.api,e)}updateDeviceName(t,e){const n=Object.assign(Object.assign({},a.p.info.write),{session:t,data:e});return this.http.post(this.api,n)}}return t.\u0275fac=function(e){return new(e||t)(d.Xb(O.a),d.Xb(C.b))},t.\u0275prov=d.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),k=(()=>{class t{constructor(t,e){this.api=t,this.http=e}getOptions(t){const e=Object.assign(Object.assign({},a.p.optionsByte.read),{session:t});return this.http.post(this.api,e)}updateOptions(t,e){const n=Object.assign(Object.assign({},a.p.optionsByte.write),{session:t,data:e});return this.http.post(this.api,n)}}return t.\u0275fac=function(e){return new(e||t)(d.Xb(O.a),d.Xb(C.b))},t.\u0275prov=d.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),P=(()=>{class t{constructor(t,e){this.api=t,this.http=e}getPwdList(t){const e=Object.assign(Object.assign({},a.p.pwd.read),{session:t});return this.http.post(this.api,e)}update(t,e){const n=Object.assign(Object.assign({},a.p.pwd.write),{session:t,data:e});return this.http.post(this.api,n)}}return t.\u0275fac=function(e){return new(e||t)(d.Xb(O.a),d.Xb(C.b))},t.\u0275prov=d.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var T=n("JxTr");let w=(()=>{class t{constructor(t,e){this.api=t,this.http=e}getDataByUnicode(t){const e=Object.assign(Object.assign({},a.p.strUnicode.read),{session:t});return this.http.post(this.api,e)}writeByUnicode(t,e){const n=Object.assign(Object.assign({},a.p.strUnicode.write),{session:t,data:e});return this.http.post(this.api,n)}getDataByGbk(t){const e=Object.assign(Object.assign({},a.p.strGbk.read),{session:t});return this.http.post(this.api,e)}writeByGbk(t,e){const n=Object.assign(Object.assign({},a.p.strGbk.write),{session:t,data:e});return this.http.post(this.api,n)}}return t.\u0275fac=function(e){return new(e||t)(d.Xb(O.a),d.Xb(C.b))},t.\u0275prov=d.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),M=(()=>{class t{constructor(t,e){this.api=t,this.http=e}getTouchSensitivity(t){const e=Object.assign(Object.assign({},a.p.touch.read),{session:t});return this.http.post(this.api,e)}setToucchSensitivity(t,e){const n=Object.assign(Object.assign({},a.p.touch.write),{session:t,data:e});return this.http.post(this.api,n)}}return t.\u0275fac=function(e){return new(e||t)(d.Xb(O.a),d.Xb(C.b))},t.\u0275prov=d.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var _=n("jtHE");let B=(()=>{class t{constructor(t,e){this.api=t,this.http=e,this.light$=new _.a(1)}getLight(t){const e=Object.assign(Object.assign({},a.p.light.read),{session:t});return this.http.post(this.api,e)}setLight(t,e){const n=Object.assign(Object.assign({},a.p.light.write),{session:t,data:e});return this.http.post(this.api,n)}getPaletteGroup(t){const e=Object.assign(Object.assign({},a.p.palette.read),{session:t});return this.http.post(this.api,e)}setPaletteGroup(t,e){const n=Object.assign(Object.assign({},a.p.palette.write),{session:t,data:e});return this.http.post(this.api,n)}}return t.\u0275fac=function(e){return new(e||t)(d.Xb(O.a),d.Xb(C.b))},t.\u0275prov=d.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var N=n("XiUz"),x=n("bTqV"),j=n("ofXK"),E=n("0EQZ"),I=n("FvrZ"),G=n("8yBR"),L=n("2Vo4");class ${constructor(t,e){this.config=t,this.filterList=e,this.dataChange=new L.a([]);const n=this.buildFileTree(t,0);this.dataChange.next(n)}get data(){return this.dataChange.value}buildFileTree(t,e){return Object.keys(t).reduce((n,i)=>{const c=t[i];let s={item:i,children:[],code:0};if(null!==c)s.children=this.buildFileTree(c,e+1);else{const t=Object(l.c)(i,this.filterList);s.code=t.code,s.number=null==t?void 0:t.number}return n.concat(s)},[])}}var A=n("bSwM"),D=n("NFeN"),R=n("sYmb");function F(t,e){if(1&t){const t=d.Ub();d.Tb(0,"mat-tree-node",3),d.Ob(1,"button",4),d.Tb(2,"mat-checkbox",5),d.bc("change",function(){d.tc(t);const n=e.$implicit;return d.fc().todoLeafItemSelectionToggle(n)}),d.Gc(3),d.gc(4,"translate"),d.Sb(),d.Sb()}if(2&t){const t=e.$implicit,n=d.fc();d.Bb(2),d.kc("checked",n.checklistSelection.isSelected(t)),d.Bb(1),d.Hc(d.hc(4,2,t.item))}}function U(t,e){if(1&t){const t=d.Ub();d.Tb(0,"mat-tree-node",6),d.Tb(1,"button",7),d.Tb(2,"mat-icon"),d.Gc(3),d.Sb(),d.Sb(),d.Tb(4,"mat-checkbox",8),d.bc("change",function(){d.tc(t);const n=e.$implicit;return d.fc().todoItemSelectionToggle(n)}),d.Gc(5),d.gc(6,"translate"),d.Sb(),d.Sb()}if(2&t){const t=e.$implicit,n=d.fc();d.Bb(3),d.Ic(" ",n.treeControl.isExpanded(t)?"expand_more":"chevron_right"," "),d.Bb(1),d.kc("checked",n.descendantsAllSelected(t))("indeterminate",n.descendantsPartiallySelected(t)),d.Bb(1),d.Hc(d.hc(6,4,t.item))}}let z=(()=>{class t{constructor(t){this.authService=t,this.selected=new d.o,this.flatNodeMap=new Map,this.nestedNodeMap=new Map,this.selectedParent=null,this.checklistSelection=new E.c(!0),this.destory$=new h.a,this.getLevel=t=>null==t?void 0:t.level,this.isExpandable=t=>null==t?void 0:t.expandable,this.getChildren=t=>null==t?void 0:t.children,this.hasChild=(t,e)=>null==e?void 0:e.expandable,this.transformer=(t,e)=>{var n;const i=this.nestedNodeMap.get(t),c=i&&i.item===t.item?i:{item:t.item,level:e,code:t.code,number:null==t?void 0:t.number,expandable:!!(null===(n=t.children)||void 0===n?void 0:n.length)};return this.flatNodeMap.set(c,t),this.nestedNodeMap.set(t,c),c},this.treeFlattener=new G.c(this.transformer,this.getLevel,this.isExpandable,this.getChildren),this.treeControl=new I.j(this.getLevel,this.isExpandable),this.dataSource=new G.b(this.treeControl,this.treeFlattener)}handleSelectedChange(){let t=[];this.checklistSelection.selected.forEach(e=>{const n=this.getParentNode(e);n&&(e.parent=n.item),t.push(e)}),this.selected.emit(t)}todoItemSelectionToggle(t){this.checklistSelection.toggle(t);const e=this.treeControl.getDescendants(t);this.checklistSelection.isSelected(t)?this.checklistSelection.select(...e):this.checklistSelection.deselect(...e),e.forEach(t=>this.checklistSelection.isSelected(t)),this.checkAllParentsSelection(t),this.handleSelectedChange()}todoLeafItemSelectionToggle(t){this.checklistSelection.toggle(t),this.checkAllParentsSelection(t),this.handleSelectedChange()}descendantsAllSelected(t){const e=this.treeControl.getDescendants(t);return e.length>0&&e.every(t=>this.checklistSelection.isSelected(t))}descendantsPartiallySelected(t){return this.treeControl.getDescendants(t).some(t=>this.checklistSelection.isSelected(t))&&!this.descendantsAllSelected(t)}checkAllParentsSelection(t){let e=this.getParentNode(t);for(;e;)this.checkRootNodeSelection(e),e=this.getParentNode(e)}checkRootNodeSelection(t){const e=this.checklistSelection.isSelected(t),n=this.treeControl.getDescendants(t),i=n.length>0&&n.every(t=>this.checklistSelection.isSelected(t));e&&!i?this.checklistSelection.deselect(t):!e&&i&&this.checklistSelection.select(t)}getParentNode(t){const e=this.getLevel(t);if(e<1)return null;for(let n=this.treeControl.dataNodes.indexOf(t)-1;n>=0;n--){const t=this.treeControl.dataNodes[n];if(this.getLevel(t)<e)return t}return null}updateCheckList(t){const e=this.authService.filterBackupConfigBySupport();this.database=new $(t,e),this.database.dataChange.pipe(Object(p.a)(this.destory$)).subscribe(t=>{this.dataSource.data=t})}ngOnInit(){this.updateCheckList(this.config)}ngOnChanges(t){const{config:e}=t;e&&this.updateCheckList(e.currentValue)}ngOnDestroy(){this.destory$.next(),this.destory$.complete()}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(S.a))},t.\u0275cmp=d.Hb({type:t,selectors:[["backup-option-tree"]],inputs:{config:"config"},outputs:{selected:"selected"},features:[d.zb],decls:3,vars:3,consts:[[3,"dataSource","treeControl"],["matTreeNodeToggle","","matTreeNodePadding","",4,"matTreeNodeDef"],["matTreeNodePadding","",4,"matTreeNodeDef","matTreeNodeDefWhen"],["matTreeNodeToggle","","matTreeNodePadding",""],["mat-icon-button","","disabled",""],["color","primary",3,"checked","change"],["matTreeNodePadding",""],["mat-icon-button","","matTreeNodeToggle",""],["color","primary",3,"checked","indeterminate","change"]],template:function(t,e){1&t&&(d.Tb(0,"mat-tree",0),d.Ec(1,F,5,4,"mat-tree-node",1),d.Ec(2,U,7,6,"mat-tree-node",2),d.Sb()),2&t&&(d.kc("dataSource",e.dataSource)("treeControl",e.treeControl),d.Bb(2),d.kc("matTreeNodeDefWhen",e.hasChild))},directives:[G.a,G.f,G.e,G.h,G.g,x.a,A.a,D.a],pipes:[R.c],styles:[""]}),t})();function H(t,e){if(1&t){const t=d.Ub();d.Tb(0,"button",13),d.bc("click",function(){return d.tc(t),d.fc(),d.qc(19).click()}),d.Gc(1),d.gc(2,"translate"),d.Sb()}2&t&&(d.Bb(1),d.Ic(" ",d.hc(2,1,"MANAGE.BACKUP.IMPORT_FILE")," "))}function Q(t,e){if(1&t){const t=d.Ub();d.Tb(0,"button",14),d.bc("click",function(){return d.tc(t),d.fc(),d.qc(19).click()}),d.Gc(1),d.gc(2,"translate"),d.Sb()}2&t&&(d.Bb(1),d.Ic(" ",d.hc(2,1,"MANAGE.BACKUP.IMPORT_FILE")," "))}function K(t,e){if(1&t){const t=d.Ub();d.Tb(0,"backup-option-tree",15),d.bc("selected",function(e){return d.tc(t),d.fc().cacheConfig=e}),d.Sb()}if(2&t){const t=d.fc();d.kc("config",t.config)}}let q=(()=>{class t{constructor(t,e,n,i,c,s,o,a,r,l,d,b,u,g){this._dialog=t,this._snakerbar=e,this.cacheService=n,this.deviceService=i,this.loadService=c,this.authService=s,this.buttonService=o,this.infoService=a,this.optByteService=r,this.pwdService=l,this.scriptService=d,this.stringService=b,this.touchService=u,this.lightsService=g,this.action="backup",this.cacheConfig=[],this.destory$=new h.a,this.handelChangeAction("backup"),i.device$.pipe(Object(p.a)(this.destory$)).subscribe(t=>this.currentDevice=t)}confirm(){this.cacheConfig&&("backup"===this.action?this.backup(this.cacheConfig):this.restore(this.cacheConfig))}handelChangeAction(t){if(this.action=t,this.config=null,this.cacheConfig=null,"backup"===this.action){const t=this.authService.filterBackupConfigBySupport();this.config=this.createConfigByBackup(t)}}createConfigByBackup(t){let e={};return t.forEach(t=>{e[t.key]=t.children?this.createConfigByBackup(t.children):null}),e}backup(t){return Object(s.a)(this,void 0,void 0,function*(){this.loadService.loading();const e=this.createBackupQueueByConfig(t),n=yield this.createDataByQueue(e),i=Object(l.b)(this.currentDevice.product_id,n);this.loadService.complete(),this.backup2Json(i)})}createBackupQueueByConfig(t){let e=[];const n=this.currentDevice.session;return t.filter(t=>0!==t.code).forEach(t=>{let i;switch(t.code){case a.d.Button:i=this.buttonService.getKeyboardMetaByOld(n);break;case a.d.ButtonV2:i=this.buttonService.getKeyboardMeta(n);break;case a.d.MetaInfo:i=this.infoService.getDeviceName(n);break;case a.d.OptionByte:i=this.optByteService.getOptions(n);break;case a.d.Password:i=this.pwdService.getPwdList(n);break;case a.d.ScriptEdit:i=this.scriptService.getScriptsSteps(n);break;case a.d.Scripts:i=this.scriptService.getScripts(n);break;case a.d.Strings:i=this.stringService.getDataByGbk(n);break;case a.d.Touch:i=this.touchService.getTouchSensitivity(n);break;case a.d.LightsV2:i=this.lightsService.getLight(n);break;case a.d.Palette:i=this.lightsService.getPaletteGroup(n);break;default:console.log(t)}e.push(Object.assign(Object.assign({},t),{request:i}))}),e}createDataByQueue(t){return Object(s.a)(this,void 0,void 0,function*(){return new Promise(e=>Object(s.a)(this,void 0,void 0,function*(){let n=[],i=null,c=[];for(let e=0;e<t.length;e++){const{item:s,code:o,level:l,number:p,request:h,parent:d}=t[e];let b=null,u=[];switch(o){case a.d.Scripts:b=yield h.toPromise(),u=b.data.filter(r.e);break;case a.d.ScriptEdit:0===c.length&&(c=(yield this.scriptService.getScripts(this.currentDevice.session).toPromise()).data,i=c.find(t=>1===t.code));const t=c.find(t=>t.number===p),e=Object.assign(Object.assign({},t),{code:1}),n=this.scriptService.switchScript(this.currentDevice.session,[e]);yield n.toPromise(),b=yield h.toPromise(),u=b.data.filter(r.e);break;default:b=yield h.toPromise(),u=b.data}n.push({item:s,code:o,level:l,number:p,parent:d,data:u}),i&&(yield this.scriptService.switchScript(this.currentDevice.session,[i]).toPromise())}e(n)}))})}restore(t){return Object(s.a)(this,void 0,void 0,function*(){this.loadService.loading();const e=this.createRestoreQueueByConfig(t);yield this.setConfigByRestoreQueue(e),this.loadService.complete()})}createConfigByRestory(t){let e={};return t.forEach(t=>{switch(t.level){case 1:e[t.parent]||(e[t.parent]={}),e[t.parent][t.item]=null;break;default:e[t.item]=null}}),e}createRestoreQueueByConfig(t){let e=[];const{session:n}=this.currentDevice;return t.filter(t=>0!==t.code).forEach(t=>{const i=this.restoryCache.find(e=>e.item===t.item).data;let c;switch(t.code){case a.d.Button:c=this.buttonService.updataButtonByOld(n,i);break;case a.d.ButtonV2:c=this.buttonService.updateButton(n,i);break;case a.d.MetaInfo:c=this.infoService.updateDeviceName(n,i);break;case a.d.OptionByte:c=this.optByteService.updateOptions(n,i);break;case a.d.Password:c=this.pwdService.update(n,i);break;case a.d.ScriptEdit:c=this.scriptService.writeScriptSteps(n,i);break;case a.d.Scripts:c=this.scriptService.switchScript(n,i);break;case a.d.Strings:c=this.stringService.writeByGbk(n,i);break;case a.d.Touch:c=this.touchService.setToucchSensitivity(n,i);break;case a.d.LightsV2:c=this.lightsService.setLight(n,i);break;case a.d.Palette:c=this.lightsService.setPaletteGroup(n,i)}e.push(Object.assign(Object.assign({},t),{request:c}))}),e}setConfigByRestoreQueue(t){let e=null,n=null,i=[];return new Promise(c=>Object(s.a)(this,void 0,void 0,function*(){for(let c=0;c<t.length;c++){const{code:s,request:o,number:r}=t[c];switch(s){case a.d.Scripts:const t=yield o.toPromise();n=t.data[0];break;case a.d.ScriptEdit:if(0===i.length){const t=yield this.scriptService.getScripts(this.currentDevice.session).toPromise();i=t.data,e=i.find(t=>1===t.code)}const c=i.find(t=>t.number===r),s=Object.assign(Object.assign({},c),{code:1}),l=this.scriptService.switchScript(this.currentDevice.session,[s]);yield l.toPromise(),yield o.toPromise();break;default:yield o.toPromise()}e&&(yield this.scriptService.switchScript(this.currentDevice.session,[e]).toPromise()),n&&(yield this.scriptService.switchScript(this.currentDevice.session,[n]).toPromise())}c(!0)}))}handleFileChange(t){return Object(s.a)(this,void 0,void 0,function*(){let e=(yield Object(r.t)(t)).replace(/MENU\./gi,"MENUS.");const{pid:n,mode:i,config:c}=JSON.parse(e);i!==a.b&&n!==this.currentDevice.product_id?this._snakerbar.open("Error: Device and config do not match"):(this.restoryCache=c.map(t=>this.restoryFormat(t)),this.config=this.createConfigByRestory(c))})}backup2Json(t){this._dialog.open(o.c,{data:a.g}).afterClosed().subscribe(e=>e&&Object(r.h)(t,e.content))}restoryFormat(t){const{mode:e}=this.cacheService.getAssetsByMain(t.code),n=t.data.map(t=>Object(r.f)(e,t.code)?t:Object.assign(Object.assign({},t),{code:0}));return Object.assign(Object.assign({},t),{data:n})}ngOnDestroy(){this.destory$.next(),this.destory$.complete()}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(b.b),d.Nb(u.b),d.Nb(g.a),d.Nb(m.a),d.Nb(f.a),d.Nb(S.a),d.Nb(v.a),d.Nb(y),d.Nb(k),d.Nb(P),d.Nb(T.a),d.Nb(w),d.Nb(M),d.Nb(B))},t.\u0275cmp=d.Hb({type:t,selectors:[["ng-component"]],decls:20,vars:15,consts:[[1,"backup-wrapper"],["fxLayout","row","fxLayoutAlign","space-between center",1,"backup-action"],[1,"operation-wrapper"],["mat-raised-button","",3,"color","click"],[1,"action-wrapper"],["color","primary","mat-raised-button","",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",3,"disabled","click"],[1,"select-wrapper"],[1,"content-wrapper"],["class","file-input-btn","mat-raised-button","",3,"click",4,"ngIf"],[3,"config","selected",4,"ngIf"],["accept","application/json","type","file",1,"hide",3,"change"],["fileInput",""],["color","primary","mat-raised-button","",3,"click"],["mat-raised-button","",1,"file-input-btn",3,"click"],[3,"config","selected"]],template:function(t,e){if(1&t){const t=d.Ub();d.Tb(0,"div",0),d.Tb(1,"div",1),d.Tb(2,"div",2),d.Tb(3,"button",3),d.bc("click",function(){return e.handelChangeAction("backup")}),d.Gc(4),d.gc(5,"translate"),d.Sb(),d.Tb(6,"button",3),d.bc("click",function(){return e.handelChangeAction("restore")}),d.Gc(7),d.gc(8,"translate"),d.Sb(),d.Sb(),d.Tb(9,"div",4),d.Ec(10,H,3,3,"button",5),d.Tb(11,"button",6),d.bc("click",function(){return e.confirm()}),d.Gc(12),d.gc(13,"translate"),d.Sb(),d.Sb(),d.Sb(),d.Tb(14,"div",7),d.Tb(15,"div",8),d.Ec(16,Q,3,3,"button",9),d.Ec(17,K,1,1,"backup-option-tree",10),d.Sb(),d.Sb(),d.Sb(),d.Tb(18,"input",11,12),d.bc("change",function(){d.tc(t);const n=d.qc(19);return e.handleFileChange(n.files[0]),n.value=""}),d.Sb()}2&t&&(d.Bb(3),d.kc("color","backup"===e.action?"primary":""),d.Bb(1),d.Ic(" ",d.hc(5,9,"MANAGE.BACKUP.BACKUP")," "),d.Bb(2),d.kc("color","restore"===e.action?"primary":""),d.Bb(1),d.Ic(" ",d.hc(8,11,"MANAGE.BACKUP.RESTORE")," "),d.Bb(3),d.kc("ngIf","restore"===e.action&&e.config),d.Bb(1),d.kc("disabled",!e.cacheConfig||0===(null==e.cacheConfig?null:e.cacheConfig.length)),d.Bb(1),d.Ic(" ",d.hc(13,13,"COMMON.CONFIRM")," "),d.Bb(4),d.kc("ngIf","restore"===e.action&&!e.config),d.Bb(1),d.kc("ngIf",e.config))},directives:[N.b,N.a,x.a,j.k,z],pipes:[R.c],styles:[".backup-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:56.25rem;height:750px;padding-top:3rem;margin:0 auto}.backup-wrapper[_ngcontent-%COMP%]   .backup-action[_ngcontent-%COMP%]{height:60px;line-height:60px}.backup-wrapper[_ngcontent-%COMP%]   .backup-action[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 4px;width:120px}.backup-wrapper[_ngcontent-%COMP%]   .select-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;background:#21272b;padding:.5rem;border-radius:4px;height:610px;overflow:auto}.backup-wrapper[_ngcontent-%COMP%]   .select-wrapper[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]{position:relative;flex:1;overflow:auto}.backup-wrapper[_ngcontent-%COMP%]   .select-wrapper[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   .file-input-btn[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}"]}),t})();var J=n("lJxs"),X=n("Qu3c"),V=n("znSr"),W=n("P/1d");const Y=function(t){return{background:t}};function Z(t,e){if(1&t){const t=d.Ub();d.Tb(0,"div",9),d.bc("click",function(){d.tc(t);const n=e.index,i=d.fc().index;return d.fc().selectColor(i,n)}),d.Sb()}if(2&t){const t=e.$implicit,n=e.index,i=d.fc().$implicit,c=d.fc();d.Fb("active",c.isCurrentColor(i,n)),d.kc("ngStyle",d.nc(3,Y,t.bg))}}function tt(t,e){if(1&t){const t=d.Ub();d.Rb(0),d.Tb(1,"div",4),d.Tb(2,"div",5),d.Gc(3),d.Sb(),d.Tb(4,"div",6),d.Ec(5,Z,1,5,"div",7),d.Sb(),d.Tb(6,"mat-icon",8),d.bc("click",function(){d.tc(t);const n=e.index;return d.fc().createRandomPalette(n)}),d.gc(7,"translate"),d.Gc(8," refresh "),d.Sb(),d.Sb(),d.Qb()}if(2&t){const t=e.$implicit,n=d.fc();d.Bb(1),d.Fb("active",n.isCurrentPalette(t)),d.Bb(2),d.Hc(n.orderFormat(t.number+1)),d.Bb(2),d.kc("ngForOf",t.colors),d.Bb(1),d.kc("matTooltip",d.hc(7,5,"COMMON.RANDOM"))}}function et(t,e){if(1&t){const t=d.Ub();d.Tb(0,"div",10),d.Tb(1,"color-sketch",11),d.bc("onChangeComplete",function(e){return d.tc(t),d.fc().changeComplete(e.color)}),d.Sb(),d.Sb()}if(2&t){const t=d.fc();d.Bb(1),d.kc("color",t.color)}}let nt=(()=>{class t{constructor(t,e,n){this.deviceService=t,this.lightService=e,this.loadService=n,this.paletteGroup=[],this.paletteIndex=0,this.colorIndex=0,this.destory$=new h.a,t.device$.pipe(Object(p.a)(this.destory$)).subscribe(t=>{t&&(this.session=t.session)})}ngOnInit(){return Object(s.a)(this,void 0,void 0,function*(){this.loadService.loading(),yield this.updatePaletteGroup(),this.selectColor(0,0),this.loadService.complete()})}createRandomPalette(t){return Object(s.a)(this,void 0,void 0,function*(){const{paletteIndex:e,colorIndex:n}=this;this.selectColor(t,t===e?n:0);const i=this.createColorsByRandom(),c=this.createColorResult(i);this.updatePalette(c)})}changeComplete(t){const e=this.createColorsByRgba(t.rgb),n=this.createColorResult(e);this.updatePalette(n)}selectColor(t,e){this.paletteIndex=t,this.palette=this.paletteGroup[t],this.colorIndex=e,this.color=this.palette.colors[e]}updatePalette(t){return Object(s.a)(this,void 0,void 0,function*(){const{number:e}=this.palette;this.loadService.loading(),yield this.setPaletteGroup({code:10,number:e,values:t}),yield this.updatePaletteGroup(),this.loadService.complete()})}updatePaletteGroup(){return Object(s.a)(this,void 0,void 0,function*(){const t=yield this.getPaletteGroup();this.paletteGroup=this.parsePaletteGroup(t),this.selectColor(this.paletteIndex,this.colorIndex)})}createColorResult(t){return[0].concat(t.map(t=>[t.r,t.g,t.b]).reduce((t,e)=>t.concat(e))).concat([0,0])}createColorsByRgba(t){const{r:e,g:n,b:i}=t,{colorIndex:c}=this;let{colors:s}=this.palette;return s[c]=Object.assign({r:e,g:n,b:i},{bg:Object(r.q)({r:e,g:n,b:i})}),s}createColorsByRandom(){const{colors:t}=this.palette;return t.map(t=>{let e=Object.assign(Object.assign({},Object(r.u)()),{bg:""});return e.bg=Object(r.q)(e),e})}createColors(t){let e=[];for(let n=1;n<t.length-2;n+=3){let i={r:t[n],g:t[n+1],b:t[n+2],bg:""};i.bg=Object(r.q)(i),e.push(i)}return e}orderFormat(t){return t>9?t:"0"+t}isCurrentPalette(t){return t.number===this.palette.number}isCurrentColor(t,e){return t.number===this.paletteIndex&&e===this.colorIndex}parsePaletteGroup(t){return t.map(t=>{const e=this.createColors(t.values);return{number:t.number,colors:e}})}getPaletteGroup(){return this.lightService.getPaletteGroup(this.session).pipe(Object(J.a)(t=>t.data)).toPromise()}setPaletteGroup(t){return this.lightService.setPaletteGroup(this.session,[t]).toPromise()}ngOnDestroy(){this.destory$.next(),this.destory$.complete()}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(m.a),d.Nb(B),d.Nb(f.a))},t.\u0275cmp=d.Hb({type:t,selectors:[["ng-component"]],decls:4,vars:2,consts:[[1,"color-palette-container"],[1,"color-palette-box"],[4,"ngFor","ngForOf"],["class","color-picker-box",4,"ngIf"],[1,"color-palette-list"],[1,"order"],[1,"color-table"],["class","color-item link",3,"ngStyle","active","click",4,"ngFor","ngForOf"],["matTooltipPosition","above",1,"refresh-btn","action-btn",3,"matTooltip","click"],[1,"color-item","link",3,"ngStyle","click"],[1,"color-picker-box"],["disableAlpha","",3,"color","onChangeComplete"]],template:function(t,e){1&t&&(d.Tb(0,"div",0),d.Tb(1,"div",1),d.Ec(2,tt,9,7,"ng-container",2),d.Sb(),d.Ec(3,et,2,1,"div",3),d.Sb()),2&t&&(d.Bb(2),d.kc("ngForOf",e.paletteGroup),d.Bb(1),d.kc("ngIf",e.color))},directives:[j.j,j.k,D.a,X.a,j.l,V.a,W.b],pipes:[R.c],styles:[".color-palette-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%}.color-palette-container[_ngcontent-%COMP%]   .color-palette-box[_ngcontent-%COMP%]{height:590px;overflow:auto;padding:.3125rem}.color-palette-container[_ngcontent-%COMP%]   .color-palette-box[_ngcontent-%COMP%]   .color-palette-list[_ngcontent-%COMP%]{display:flex;height:3.125rem;background-color:#2e353b;align-items:center;padding:0 1rem;margin-bottom:.5rem;box-shadow:0 1px 2px 0 #000}.color-palette-container[_ngcontent-%COMP%]   .color-palette-box[_ngcontent-%COMP%]   .color-palette-list.active[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%], .color-palette-container[_ngcontent-%COMP%]   .color-palette-box[_ngcontent-%COMP%]   .color-palette-list[_ngcontent-%COMP%]:hover   .order[_ngcontent-%COMP%]{color:#c2185b}.color-palette-container[_ngcontent-%COMP%]   .color-palette-box[_ngcontent-%COMP%]   .color-palette-list[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%]{font-family:Impact;width:3.75rem}.color-palette-container[_ngcontent-%COMP%]   .color-palette-box[_ngcontent-%COMP%]   .color-palette-list[_ngcontent-%COMP%]   .color-table[_ngcontent-%COMP%]{display:flex;border:1px solid #000;margin-right:2rem}.color-palette-container[_ngcontent-%COMP%]   .color-palette-box[_ngcontent-%COMP%]   .color-palette-list[_ngcontent-%COMP%]   .color-table[_ngcontent-%COMP%]   .color-item[_ngcontent-%COMP%]{width:1.875rem;height:1.875rem;transition:all .1s ease-in-out}.color-palette-container[_ngcontent-%COMP%]   .color-palette-box[_ngcontent-%COMP%]   .color-palette-list[_ngcontent-%COMP%]   .color-table[_ngcontent-%COMP%]   .color-item[_ngcontent-%COMP%]:hover{position:relative;transform:scale(1.2)}.color-palette-container[_ngcontent-%COMP%]   .color-palette-box[_ngcontent-%COMP%]   .color-palette-list[_ngcontent-%COMP%]   .color-table[_ngcontent-%COMP%]   .color-item.active[_ngcontent-%COMP%]{position:relative;transform:scale(1.3)}.color-palette-container[_ngcontent-%COMP%]   .color-picker-box[_ngcontent-%COMP%]{position:relative;margin-left:4rem}"]}),t})();var it=n("ysIn");function ct(t,e){if(1&t){const t=d.Ub();d.Tb(0,"sayo-button-instance",4),d.bc("selected",function(e){return d.tc(t),d.fc(2).selectButton(e)}),d.Sb()}if(2&t){const t=e.$implicit,n=d.fc(2);d.kc("instance",t)("buttonCmdOpt",n.buttonCmdOpt)}}function st(t,e){if(1&t&&(d.Rb(0),d.Ec(1,ct,1,2,"sayo-button-instance",3),d.Qb()),2&t){const t=d.fc();d.Bb(1),d.kc("ngForOf",t.buttonList)}}let ot=(()=>{class t{constructor(t,e,n,i,c){this._dialog=t,this.deviceService=e,this.buttonsService=n,this.cacheService=i,this.loadService=c,this.buttonList=[],this.destory$=new h.a,e.device$.pipe(Object(p.a)(this.destory$)).subscribe(t=>{t&&(this.session=t.session,this.buttonCmdOpt=i.getAssetsByMain(a.d.Button))}),c.loading(),n.getKeyboardMetaByOld(this.session).pipe(Object(p.a)(this.destory$)).subscribe(t=>{this.buttonList=t.data,c.complete()}),n.buttonOld$.pipe(Object(p.a)(this.destory$)).subscribe(t=>{t&&(this.buttonList=Object(r.j)(this.buttonList,t))})}selectButton(t){this._dialog.open(o.a,{data:{button:t,session:this.session,buttonCmdOpt:this.buttonCmdOpt}})}ngOnDestroy(){this.destory$.next(),this.destory$.complete()}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(b.b),d.Nb(m.a),d.Nb(v.a),d.Nb(g.a),d.Nb(f.a))},t.\u0275cmp=d.Hb({type:t,selectors:[["ng-component"]],decls:3,vars:1,consts:[[1,"page-wrapper"],[1,"buttons-list-wrapper"],[4,"ngIf"],[3,"instance","buttonCmdOpt","selected",4,"ngFor","ngForOf"],[3,"instance","buttonCmdOpt","selected"]],template:function(t,e){1&t&&(d.Tb(0,"div",0),d.Tb(1,"div",1),d.Ec(2,st,2,1,"ng-container",2),d.Sb(),d.Sb()),2&t&&(d.Bb(2),d.kc("ngIf",e.buttonList.length>0))},directives:[j.k,j.j,it.a],styles:[".page-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:100%;height:100%}.buttons-list-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;flex-wrap:wrap;overflow:hidden;padding:.5rem;background-color:#111;border-radius:4px;max-width:560px;max-height:80%}.buttons-list-wrapper[_ngcontent-%COMP%]   sayo-button-instance[_ngcontent-%COMP%]{display:block;margin:2px}"]}),t})();var at=n("XVKj");function rt(t,e){if(1&t){const t=d.Ub();d.Tb(0,"keyboard-render",4),d.bc("selected",function(e){return d.tc(t),d.fc().selectButton(e)}),d.Sb()}if(2&t){const t=d.fc();d.kc("buttonList",t.buttonList)("fn",t.fn)}}function lt(t,e){if(1&t){const t=d.Ub();d.Tb(0,"button",5),d.bc("click",function(){d.tc(t);const n=e.$implicit;return d.fc().fn=n}),d.Gc(1),d.gc(2,"translate"),d.Sb()}if(2&t){const t=e.$implicit,n=e.index,i=d.fc();d.kc("color",t===i.fn?"primary":""),d.Bb(1),d.Ic(" ",d.hc(2,2,i.getFnName(t,n))," ")}}let pt=(()=>{class t{constructor(t,e,n,i,c){this._dialog=t,this.deviceService=e,this.buttonsService=n,this.cacheService=i,this.loadService=c,this.buttonList=[],this.fn=0,this.destory$=new h.a,e.device$.pipe(Object(p.a)(this.destory$)).subscribe(t=>{t&&(this.session=t.session,this.buttonCmdOpt=i.getAssetsByMain(a.d.Button))}),c.loading(),n.getKeyboardMeta(this.session).pipe(Object(p.a)(this.destory$)).subscribe(t=>{this.buttonList=t.data.filter(t=>0!==t.code),this.fnOpt=this.buttonList[0].key_data.map((t,e)=>e),c.complete()}),n.button$.pipe(Object(p.a)(this.destory$)).subscribe(t=>{t&&(this.buttonList=Object(r.j)(this.buttonList,t))})}selectButton(t){this._dialog.open(o.e,{data:{button:t,fn:this.fn,session:this.session,buttonCmdOpt:this.buttonCmdOpt}})}getFnName(t,e){return 0===t?"MANAGE.KEY.FN_BASIC":"FN"+e}ngOnDestroy(){this.destory$.next(),this.destory$.complete()}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(b.b),d.Nb(m.a),d.Nb(v.a),d.Nb(g.a),d.Nb(f.a))},t.\u0275cmp=d.Hb({type:t,selectors:[["ng-component"]],decls:4,vars:2,consts:[[1,"keyboard-ctrl-container","flex-center"],[3,"buttonList","fn","selected",4,"ngIf"],[1,"fn-btn-group"],["mat-raised-button","",3,"color","click",4,"ngFor","ngForOf"],[3,"buttonList","fn","selected"],["mat-raised-button","",3,"color","click"]],template:function(t,e){1&t&&(d.Tb(0,"div",0),d.Ec(1,rt,1,2,"keyboard-render",1),d.Tb(2,"div",2),d.Ec(3,lt,3,4,"button",3),d.Sb(),d.Sb()),2&t&&(d.Bb(1),d.kc("ngIf",(null==e.buttonList?null:e.buttonList.length)>0),d.Bb(2),d.kc("ngForOf",e.fnOpt))},directives:[j.k,j.j,at.a,x.a],pipes:[R.c],styles:[".keyboard-ctrl-container[_ngcontent-%COMP%]{height:100%;flex-direction:column}.fn-btn-group[_ngcontent-%COMP%]{margin-top:5rem;display:flex}.fn-btn-group[_ngcontent-%COMP%]   .mat-raised-button[_ngcontent-%COMP%]{margin:0 .3rem}"]}),t})();var ht=n("kmnG"),dt=n("d3UM"),bt=n("FKr1"),ut=n("qFsG"),gt=n("1jcm");function mt(t,e){1&t&&d.Pb(0)}const ft=function(t){return{$implicit:t}};function St(t,e){if(1&t&&(d.Rb(0),d.Ec(1,mt,1,0,"ng-container",5),d.Qb()),2&t){const t=d.fc(),e=d.qc(14);d.Bb(1),d.kc("ngTemplateOutlet",e)("ngTemplateOutletContext",d.nc(2,ft,t.opt))}}function vt(t,e){1&t&&d.Pb(0)}function Ot(t,e){if(1&t&&(d.Rb(0),d.Ec(1,vt,1,0,"ng-container",5),d.Qb()),2&t){const t=d.fc(),e=d.qc(14);d.Bb(1),d.kc("ngTemplateOutlet",e)("ngTemplateOutletContext",d.nc(2,ft,t.opt))}}function Ct(t,e){1&t&&d.Pb(0)}function yt(t,e){if(1&t&&(d.Rb(0),d.Ec(1,Ct,1,0,"ng-container",5),d.Qb()),2&t){const t=d.fc(),e=d.qc(14);d.Bb(1),d.kc("ngTemplateOutlet",e)("ngTemplateOutletContext",d.nc(2,ft,t.opt))}}function kt(t,e){if(1&t&&(d.Tb(0,"mat-option",8),d.Gc(1),d.gc(2,"translate"),d.Sb()),2&t){const t=e.$implicit;d.kc("value",null==t?null:t.code),d.Bb(1),d.Ic(" ",d.hc(2,2,t.name)," ")}}function Pt(t,e){if(1&t){const t=d.Ub();d.Rb(0),d.Tb(1,"mat-form-field"),d.Tb(2,"mat-select",6),d.bc("selectionChange",function(e){return d.tc(t),d.fc().saveBySelect(e.value)}),d.Ec(3,kt,3,4,"mat-option",7),d.Sb(),d.Sb(),d.Qb()}if(2&t){const t=d.fc();d.Bb(2),d.kc("value",null==t.opt?null:t.opt.code),d.Bb(1),d.kc("ngForOf",null==t.opt?null:t.opt.opts)}}function Tt(t,e){if(1&t){const t=d.Ub();d.Rb(0),d.Tb(1,"mat-form-field"),d.Tb(2,"input",9,10),d.bc("blur",function(){d.tc(t);const e=d.qc(3),n=d.fc();return n.saveByParam(e.value,null==n.opt?null:n.opt.min,null==n.opt?null:n.opt.max)}),d.Sb(),d.Tb(4,"button",11),d.bc("click",function(){d.tc(t);const e=d.qc(3),n=d.fc();return n.saveByParam(e.value,null==n.opt?null:n.opt.min,null==n.opt?null:n.opt.max)}),d.Tb(5,"mat-icon"),d.Gc(6,"save"),d.Sb(),d.Sb(),d.Sb(),d.Qb()}if(2&t){const t=d.fc();d.Bb(2),d.kc("value",null==t.opt?null:t.opt.code)}}function wt(t,e){if(1&t){const t=d.Ub();d.Rb(0),d.Tb(1,"div",12),d.Tb(2,"mat-slide-toggle",13),d.bc("change",function(e){return d.tc(t),d.fc().saveByChecked(e.checked)}),d.Sb(),d.Sb(),d.Qb()}if(2&t){const t=d.fc();d.Bb(2),d.kc("checked",t.isChecked())}}function Mt(t,e){if(1&t){const t=d.Ub();d.Rb(0),d.Tb(1,"div",12),d.Tb(2,"div",14),d.bc("click",function(){d.tc(t);const e=d.fc();return e.openAndHandleChange(e.opt.type,e.opt.code)}),d.Sb(),d.Sb(),d.Qb()}if(2&t){const t=d.fc();d.Bb(2),d.Bc("background-color",t.value)}}function _t(t,e){if(1&t){const t=d.Ub();d.Rb(0),d.Tb(1,"mat-form-field"),d.Tb(2,"input",15,10),d.bc("blur",function(){d.tc(t);const e=d.qc(3);return d.fc().saveByString(e.value)}),d.Sb(),d.Tb(4,"button",11),d.bc("click",function(){d.tc(t);const e=d.qc(3);return d.fc().saveByString(e.value)}),d.Tb(5,"mat-icon"),d.Gc(6,"save"),d.Sb(),d.Sb(),d.Sb(),d.Qb()}if(2&t){const t=d.fc();d.Bb(2),d.kc("value",t.value),d.Cb("maxlength",null==t.opt?null:t.opt.max)}}function Bt(t,e){if(1&t){const t=d.Ub();d.Tb(0,"div",12),d.Tb(1,"span"),d.Gc(2),d.gc(3,"translate"),d.Sb(),d.Tb(4,"mat-icon",16),d.bc("click",function(){d.tc(t);const n=e.$implicit;return d.fc().openAndHandleChange(n.type,n.code,n.opts)}),d.Gc(5,"create"),d.Sb(),d.Sb()}if(2&t){const t=d.fc();d.Bb(2),d.Hc(d.hc(3,1,t.value))}}const Nt={width:"1350px",maxWidth:"98vw"},xt={width:"900px"},jt={width:"750px"},Et={panelClass:"no-bg-dialog"};let It=(()=>{class t{constructor(t,e){this._dialog=t,this._snackbar=e,this.changed=new d.o}ngOnInit(){switch(this.opt.type){case"General":this.value=this.getValueByOpts(this.opt.opts);break;case"Common":this.value=this.getValueByOpts(a.r);break;case"Multi":this.value=Object(r.o)(Object(r.i)(this.opt.code,this.opt.opts));break;case"Color":let t=this.opt.code;this.value=`rgb(${t[0]},${t[1]},${t[2]})`;break;case"String":let e=this.opt.code;this.value="";for(let n=0;n<e.length;n+=2)0!==Object(r.c)(e[n],e[n+1])&&(this.value+=String.fromCodePoint(Object(r.c)(e[n],e[n+1])));break;default:this.value=""}}saveByParam(t,e,n){const i=Number(t);i>n||i<e?this._snackbar.open(`Range ${e} - ${n}!`):this.changed.emit(i)}saveByString(t){let e=[];for(let n=0;n<t.length;n++){const i=Object(r.b)(t.charCodeAt(n));e[n]=i.high,e[n+1]=i.low}this.changed.emit(e)}saveBySelect(t){this.changed.emit(t)}saveByChecked(t){this.changed.emit(t?0:1)}openAndHandleChange(t,e,n){let i,c,s;switch(t){case"General":i=o.d,c={code:e,opts:n},s=Object.assign({},xt);break;case"Common":i=o.b,c={code:e},s=Object.assign({},Nt);break;case"Multi":i=o.f,c={code:e,opts:n},s=Object.assign({},jt);break;case"Color":i=o.h,c={codes:e},s=Object.assign({},Et)}this._dialog.open(i,Object.assign({data:c},s)).afterClosed().subscribe(t=>t&&this.changed.emit(t.code))}isChecked(){return[!0,!1][this.opt.code]}getValueByOpts(t){const e=t.find(t=>t.code===this.opt.code);return e?e.name:""}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(b.b),d.Nb(u.b))},t.\u0275cmp=d.Hb({type:t,selectors:[["sayo-options-item"]],inputs:{opt:"opt"},outputs:{changed:"changed"},decls:15,vars:12,consts:[[1,"options-params-wrapper"],[1,"options-params-lable"],[3,"ngSwitch"],[4,"ngSwitchCase"],["typeDialog",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"value","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["matInput","","type","number",3,"value","blur"],["input",""],["matSuffix","","mat-icon-button","",3,"click"],[1,"options-params-content"],["color","primary",3,"checked","change"],[1,"color-box",3,"click"],["matInput","",3,"value","blur"],[3,"click"]],template:function(t,e){1&t&&(d.Tb(0,"div",0),d.Tb(1,"div",1),d.Gc(2),d.gc(3,"translate"),d.Sb(),d.Rb(4,2),d.Ec(5,St,2,4,"ng-container",3),d.Ec(6,Ot,2,4,"ng-container",3),d.Ec(7,yt,2,4,"ng-container",3),d.Ec(8,Pt,4,2,"ng-container",3),d.Ec(9,Tt,7,1,"ng-container",3),d.Ec(10,wt,3,1,"ng-container",3),d.Ec(11,Mt,3,2,"ng-container",3),d.Ec(12,_t,7,2,"ng-container",3),d.Qb(),d.Sb(),d.Ec(13,Bt,6,3,"ng-template",null,4,d.Fc)),2&t&&(d.Bb(2),d.Hc(d.hc(3,10,null==e.opt?null:e.opt.title)),d.Bb(2),d.kc("ngSwitch",null==e.opt?null:e.opt.type),d.Bb(1),d.kc("ngSwitchCase","General"),d.Bb(1),d.kc("ngSwitchCase","Common"),d.Bb(1),d.kc("ngSwitchCase","Multi"),d.Bb(1),d.kc("ngSwitchCase","Select"),d.Bb(1),d.kc("ngSwitchCase","Param"),d.Bb(1),d.kc("ngSwitchCase","Switch"),d.Bb(1),d.kc("ngSwitchCase","Color"),d.Bb(1),d.kc("ngSwitchCase","String"))},directives:[j.m,j.n,j.p,ht.b,dt.a,j.j,bt.l,ut.b,x.a,ht.f,D.a,gt.a],pipes:[R.c],styles:[".options-params-wrapper[_ngcontent-%COMP%]{display:grid;grid-template-columns:10rem 1fr}.options-params-wrapper[_ngcontent-%COMP%]   .options-params-lable[_ngcontent-%COMP%]{padding-right:1rem;display:flex;align-items:center;height:4.09375rem}.options-params-wrapper[_ngcontent-%COMP%]   .options-params-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;line-height:1.75rem}.options-params-wrapper[_ngcontent-%COMP%]   .options-params-content[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]:hover{color:#c2185b;cursor:pointer}.options-params-wrapper[_ngcontent-%COMP%]   .options-params-content[_ngcontent-%COMP%]   .color-box[_ngcontent-%COMP%]{cursor:pointer;width:100%;border:2px solid #fff;text-align:center;height:60%}.options-params-wrapper[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]:hover{color:#c2185b}"]}),t})();function Gt(t,e){if(1&t){const t=d.Ub();d.Tb(0,"sayo-options-item",1),d.bc("changed",function(n){d.tc(t);const i=e.$implicit;return d.fc().onParamsChange(n,null==i?null:i.type,null==i?null:i.index)}),d.Sb()}2&t&&d.kc("opt",e.$implicit)}let Lt=(()=>{class t{constructor(t,e,n,i){this.data=t,this.lightService=e,this.cacheService=n,this.loadService=i,this.options=[],this.result=[],this.destory$=new h.a,this.current=t.instance,this.modeList=[...t.cmdOpt.mode],this.mode=t.instance.code,this.modeOption={type:"Select",title:"MANAGE.LIGHT.MODE",code:this.mode,opts:t.cmdOpt.mode}}ngOnInit(){this.updateOptMeta(this.oprations,this.data.instance.values)}onModeChange(t){this.loadService.loading(),this.mode=t,this.updateOptMeta(this.oprations);const e=this.getResult(t,this.result);this.lightService.setLight(this.data.session,[e]).pipe(Object(p.a)(this.destory$)).subscribe(t=>this.updateLight())}onParamsChange(t,e,n){switch(this.loadService.loading(),e){case"Color":this.result[n]=t[0],this.result[n+1]=t[1],this.result[n+2]=t[2];break;default:this.result[n]=t}this.write(this.getResult(this.mode,this.result))}updateLight(){const t=this.createLight();this.lightService.light$.next(t)}createLight(){return{code:this.mode,number:this.data.instance.number,values:this.result}}updateOptMeta(t,e){this.options=[],t.map(t=>t.replace(".json","")).forEach((t,n)=>{if("no_more"!==t){const i=this.cacheService.getAssets(t),c=a.h[t];this.result[n]=e?e[n]:i.defVal,this.options.push(Object.assign(Object.assign({},{type:c,index:n,title:i.title,min:null==i?void 0:i.min,max:null==i?void 0:i.max,opts:i.data}),"Color"===c?{code:e?e.slice(n,n+3):i.defVal}:{code:e?e[n]:i.defVal}))}}),this.result=Object(r.d)(this.result,9),this.loadService.complete()}getResult(t,e){let n={code:t,number:this.current.number,values:this.current.values};return e&&e.length>0&&(n.values=e),n}write(t){this.loadService.loading(),this.lightService.setLight(this.data.session,[t]).pipe(Object(p.a)(this.destory$)).subscribe(e=>{this.current=t,this.updateOptMeta(this.oprations,this.current.values),this.updateLight()})}get oprations(){return this.modeList.find(t=>t.code===this.mode).values}ngOnDestroy(){this.destory$.next(),this.destory$.complete()}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(b.a),d.Nb(B),d.Nb(g.a),d.Nb(f.a))},t.\u0275cmp=d.Hb({type:t,selectors:[["ng-component"]],decls:6,vars:5,consts:[[1,"option-container"],[3,"opt","changed"],[3,"opt","changed",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary","matDialogClose","",1,"confirm-btn"]],template:function(t,e){1&t&&(d.Tb(0,"div",0),d.Tb(1,"sayo-options-item",1),d.bc("changed",function(t){return e.onModeChange(t)}),d.Sb(),d.Ec(2,Gt,1,1,"sayo-options-item",2),d.Tb(3,"button",3),d.Gc(4),d.gc(5,"translate"),d.Sb(),d.Sb()),2&t&&(d.Bb(1),d.kc("opt",e.modeOption),d.Bb(1),d.kc("ngForOf",e.options),d.Bb(2),d.Ic(" ",d.hc(5,3,"COMMON.CONFIRM")," "))},directives:[It,j.j,x.a,b.d],pipes:[R.c],styles:[".option-container[_ngcontent-%COMP%]{height:100%;width:30rem}.confirm-btn[_ngcontent-%COMP%]{width:100%;margin-top:3rem}"]}),t})();var $t=n("BUd1");function At(t,e){if(1&t){const t=d.Ub();d.Rb(0),d.Tb(1,"div",4),d.bc("click",function(){d.tc(t);const n=e.$implicit;return d.fc(2).select(n.number)}),d.Gc(2),d.gc(3,"translate"),d.Sb(),d.Qb()}if(2&t){const t=e.$implicit;d.Bb(1),d.kc("ngStyle",t.display)("matTooltip",t.name),d.Bb(1),d.Ic(" ",d.hc(3,3,t.name)," ")}}function Dt(t,e){if(1&t&&(d.Tb(0,"div",2),d.Ec(1,At,4,5,"ng-container",3),d.Sb()),2&t){const t=d.fc();d.kc("ngStyle",t.keyboardContanerDisplay),d.Bb(1),d.kc("ngForOf",t.buttons)}}let Rt=(()=>{class t{constructor(t){this._keyboard=t,this.selected=new d.o,this.ratio=1,this.buttons=[],this.keyboardContanerDisplay={width:"1200px",height:"450px"}}ngOnInit(){const{width:t,height:e}=this._keyboard.size;this.ratio=this._keyboard.calcKeyboardRatio(t,e,1200,450),this.keyboardContanerDisplay={width:t*this.ratio+"px",height:e*this.ratio+"px"},this.updateButtons(this.buttonList)}ngOnChanges(t){const{buttonList:e}=t;e&&this.updateButtons(this.buttonList)}updateButtons(t){this.buttons=t.map(t=>{let e={code:1,info:this._keyboard.displayCache.get(t.number),number:t.number,key_data:[{mode:t.code,values:t.values}]};const n=this._keyboard.createButtonDisplay(e,this.ratio);return n.background=this._keyboard.getLightButtonColor(t),{display:n,name:this._keyboard.getLightButtonName(t),number:t.number}})}select(t){const e=this.buttonList.find(e=>e.number===t);this.selected.emit(e)}}return t.\u0275fac=function(e){return new(e||t)(d.Nb($t.a))},t.\u0275cmp=d.Hb({type:t,selectors:[["lignt-keyboard-render"]],inputs:{buttonList:"buttonList"},outputs:{selected:"selected"},features:[d.zb],decls:2,vars:2,consts:[[1,"keyboard-container","flex-center",3,"ngStyle"],["class","keyboard-box",3,"ngStyle",4,"ngIf"],[1,"keyboard-box",3,"ngStyle"],[4,"ngFor","ngForOf"],["matTooltipPosition","above",1,"sayo-button","one-line",3,"ngStyle","matTooltip","click"]],template:function(t,e){1&t&&(d.Tb(0,"div",0),d.Ec(1,Dt,2,2,"div",1),d.Sb()),2&t&&(d.kc("ngStyle",e.keyboardContanerDisplay),d.Bb(1),d.kc("ngIf",(null==e.buttons?null:e.buttons.length)>0))},directives:[j.l,V.a,j.k,j.j,X.a],pipes:[R.c],styles:[".keyboard-container[_ngcontent-%COMP%]   .keyboard-box[_ngcontent-%COMP%]{position:relative;background:#111;box-shadow:0 6px 15px 4px #222;border-radius:8px}.keyboard-container[_ngcontent-%COMP%]   .keyboard-box[_ngcontent-%COMP%]   .sayo-button[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:12px;cursor:pointer;position:absolute;background-color:#2e353b;z-index:1}.keyboard-container[_ngcontent-%COMP%]   .keyboard-box[_ngcontent-%COMP%]   .sayo-button.active[_ngcontent-%COMP%], .keyboard-container[_ngcontent-%COMP%]   .keyboard-box[_ngcontent-%COMP%]   .sayo-button[_ngcontent-%COMP%]:hover{background-color:#c2185b}"]}),t})(),Ft=(()=>{class t{constructor(t,e,n,i,c){this._dialog=t,this.deviceService=e,this.cacheService=n,this.lightService=i,this.loadService=c,this.LightList=[],this.destory$=new h.a,e.device$.pipe(Object(p.a)(this.destory$)).subscribe(t=>{t&&(this.session=t.session,this.cmdOpt=n.getAssetsByMain(a.d.LightsV2))}),c.loading(),i.getLight(this.session).pipe(Object(p.a)(this.destory$)).subscribe(t=>{this.LightList=t.data,c.complete()}),i.light$.pipe(Object(p.a)(this.destory$)).subscribe(t=>{t&&(this.LightList=Object(r.j)(this.LightList,t))})}select(t){this._dialog.open(Lt,{data:{instance:t,session:this.session,cmdOpt:this.cmdOpt}})}ngOnDestroy(){this.destory$.next(),this.destory$.complete()}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(b.b),d.Nb(m.a),d.Nb(g.a),d.Nb(B),d.Nb(f.a))},t.\u0275cmp=d.Hb({type:t,selectors:[["ng-component"]],decls:3,vars:1,consts:[[1,"keyboard-ctrl-container","flex-center"],[1,"list-wrapper"],[3,"buttonList","selected"]],template:function(t,e){1&t&&(d.Tb(0,"div",0),d.Tb(1,"div",1),d.Tb(2,"lignt-keyboard-render",2),d.bc("selected",function(t){return e.select(t)}),d.Sb(),d.Sb(),d.Sb()),2&t&&(d.Bb(2),d.kc("buttonList",e.LightList))},directives:[Rt],styles:[".keyboard-ctrl-container[_ngcontent-%COMP%]{height:100%;flex-direction:column}"]}),t})();var Ut=n("0wH7"),zt=n("zjsp");let Ht=(()=>{class t{constructor(t){this.authService=t}ngOnInit(){const t=this.authService.filterMenuBySurport();this.manageNavList=[...t,...a.e]}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(S.a))},t.\u0275cmp=d.Hb({type:t,selectors:[["ng-component"]],decls:4,vars:1,consts:[[3,"navList"],[1,"manage-container"]],template:function(t,e){1&t&&(d.Ob(0,"sayo-nav",0),d.Tb(1,"div",1),d.Ob(2,"save-forver"),d.Ob(3,"router-outlet"),d.Sb()),2&t&&d.kc("navList",e.manageNavList)},directives:[Ut.a,zt.a,c.g],styles:[".manage-container[_ngcontent-%COMP%]{position:relative;height:calc(100% - 3.125rem)}"]}),t})();var Qt=n("Lbv8");function Kt(t,e){if(1&t){const t=d.Ub();d.Rb(0),d.Tb(1,"div",1),d.Tb(2,"div",2),d.Tb(3,"div",3),d.Gc(4),d.gc(5,"translate"),d.Sb(),d.Tb(6,"div",4),d.Tb(7,"sayo-editor-input",5),d.bc("update",function(e){return d.tc(t),d.fc().updataDeviceName(e)}),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Qb()}if(2&t){const t=d.fc();d.Bb(4),d.Hc(d.hc(5,2,"MANAGE.META.NAME")),d.Bb(3),d.kc("content",t.options.values[0])}}let qt=(()=>{class t{constructor(t,e,n){this.deviceService=t,this.infoService=e,this.loadService=n,this.destory$=new h.a,t.device$.pipe(Object(p.a)(this.destory$)).subscribe(t=>{t&&(this.session=t.session)}),n.loading(),e.getDeviceName(this.session).pipe(Object(p.a)(this.destory$)).subscribe(t=>{this.options=t.data[0],n.complete()})}updataDeviceName(t){return Object(s.a)(this,void 0,void 0,function*(){this.loadService.loading();const{code:e,number:n}=this.options,i=[{code:e,number:n,values:[t]}];yield this.infoService.updateDeviceName(this.session,i).toPromise(),this.loadService.complete()})}ngOnDestroy(){this.destory$.next(),this.destory$.complete()}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(m.a),d.Nb(y),d.Nb(f.a))},t.\u0275cmp=d.Hb({type:t,selectors:[["ng-component"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"meta-info-container"],[1,"meta-item"],[1,"label"],[1,"result"],[3,"content","update"]],template:function(t,e){1&t&&d.Ec(0,Kt,8,4,"ng-container",0),2&t&&d.kc("ngIf",e.options)},directives:[j.k,Qt.a],pipes:[R.c],styles:[".meta-info-container[_ngcontent-%COMP%]{width:56.25rem;margin:0 auto;padding:4rem 0}.meta-item[_ngcontent-%COMP%]{display:flex;align-items:center;border:1px solid #797979;border-radius:4px;padding:1rem}.meta-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{width:10rem}"]}),t})();function Jt(t,e){if(1&t){const t=d.Ub();d.Tb(0,"sayo-options-item",2),d.bc("changed",function(n){d.tc(t);const i=e.$implicit,c=e.index;return d.fc().onParamsChange(n,i.type,c)}),d.Sb()}2&t&&d.kc("opt",e.$implicit)}let Xt=(()=>{class t{constructor(t,e,n,i){this.deviceService=t,this.cacheService=e,this.optByteService=n,this.loadService=i,this.options=[],this.result=[],this.destory$=new h.a,t.device$.pipe(Object(p.a)(this.destory$)).subscribe(t=>{t&&(this.session=t.session,this.cmdOpt=e.getAssetsByMain(a.d.OptionByte))})}ngOnInit(){this.loadService.loading(),this.optByteService.getOptions(this.session).pipe(Object(p.a)(this.destory$)).subscribe(t=>{this.optionByte=t.data,this.result=this.optionByte[0].values,this.updateOptionsMeta(this.result)})}updateOptionsMeta(t){const e=this.cmdOpt.mode.find(t=>0===t.code).values.map(t=>t.replace(".json",""));this.options=[];for(let n=0;n<e.length;n++){const{title:i,data:c,min:s,max:o}=this.cacheService.getAssets(e[n]);this.options[n]={type:a.h[e[n]],title:i,min:s,max:o,code:t[n],opts:c,index:n}}this.loadService.complete()}onParamsChange(t,e,n){this.loadService.loading(),this.result[n]=t;const i={code:0,number:0,values:this.result};this.optByteService.updateOptions(this.session,[i]).pipe(Object(p.a)(this.destory$)).subscribe(t=>{this.optionByte=Object(r.j)(this.optionByte,i),this.updateOptionsMeta(this.result)})}ngOnDestroy(){this.destory$.next(),this.destory$.complete()}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(m.a),d.Nb(g.a),d.Nb(k),d.Nb(f.a))},t.\u0275cmp=d.Hb({type:t,selectors:[["ng-component"]],decls:2,vars:1,consts:[[1,"page-wrapper"],[3,"opt","changed",4,"ngFor","ngForOf"],[3,"opt","changed"]],template:function(t,e){1&t&&(d.Tb(0,"div",0),d.Ec(1,Jt,1,1,"sayo-options-item",1),d.Sb()),2&t&&(d.Bb(1),d.kc("ngForOf",e.options))},directives:[j.j,It],styles:[".page-wrapper[_ngcontent-%COMP%]{width:900px;margin:auto;padding:3rem 0;max-height:100%}.page-wrapper[_ngcontent-%COMP%]   .option-byte-instance[_ngcontent-%COMP%]{border-bottom:1px solid #424b52}"]}),t})();var Vt=n("/HAf"),Wt=n("ghhW"),Yt=n("0Pua"),Zt=n("dgCN"),te=n("3Pt+"),ee=n("M9IT"),ne=n("f0Cb"),ie=n("STbY");function ce(t,e){if(1&t&&(d.Rb(0),d.Gc(1),d.gc(2,"translate"),d.Qb()),2&t){const t=d.fc().$implicit;d.Bb(1),d.Ic(" ",d.hc(2,1,null==t?null:t.name)," ")}}function se(t,e){if(1&t&&(d.Rb(0),d.Gc(1),d.gc(2,"translate"),d.Qb()),2&t){const t=d.fc().$implicit;d.Bb(1),d.Ic(" ",d.hc(2,1,null==t?null:t.name)," ")}}function oe(t,e){if(1&t&&(d.Rb(0),d.Gc(1),d.gc(2,"translate"),d.Qb()),2&t){const t=d.fc().$implicit;d.Bb(1),d.Ic(" ",d.hc(2,1,null==t?null:t.name)," ")}}function ae(t,e){if(1&t&&(d.Rb(0),d.Gc(1),d.gc(2,"translate"),d.Qb()),2&t){const t=d.fc().$implicit;d.Bb(1),d.Ic(" ",d.hc(2,1,null==t?null:t.name)," ")}}function re(t,e){if(1&t&&d.Ob(0,"div",17),2&t){const t=d.fc().$implicit;d.Bc("background-color",null==t?null:t.name)}}function le(t,e){if(1&t&&(d.Tb(0,"div",13),d.Rb(1,14),d.Ec(2,ce,3,3,"ng-container",15),d.Ec(3,se,3,3,"ng-container",15),d.Ec(4,oe,3,3,"ng-container",15),d.Ec(5,ae,3,3,"ng-container",15),d.Ec(6,re,1,2,"div",16),d.Qb(),d.Sb()),2&t){const t=e.$implicit;d.Bb(1),d.kc("ngSwitch",null==t?null:t.type),d.Bb(1),d.kc("ngSwitchCase","Param"),d.Bb(1),d.kc("ngSwitchCase","General"),d.Bb(1),d.kc("ngSwitchCase","Multi"),d.Bb(1),d.kc("ngSwitchCase","Common"),d.Bb(1),d.kc("ngSwitchCase","Color")}}function pe(t,e){if(1&t){const t=d.Ub();d.Rb(0),d.Tb(1,"div",3),d.Tb(2,"div",4),d.bc("click",function(){d.tc(t);const e=d.fc();return e.openScriptStepEditDialog(e.step)}),d.Tb(3,"div",5),d.Gc(4),d.Sb(),d.Tb(5,"div",6),d.Tb(6,"div",7),d.Tb(7,"div",8),d.Gc(8),d.gc(9,"translate"),d.gc(10,"translate"),d.Sb(),d.Sb(),d.Tb(11,"div",9),d.Tb(12,"div",10),d.Gc(13),d.gc(14,"translate"),d.Sb(),d.Ec(15,le,7,6,"div",11),d.Sb(),d.Sb(),d.Sb(),d.Tb(16,"mat-icon",12),d.Gc(17,"view_headline"),d.Sb(),d.Sb(),d.Qb()}if(2&t){const t=d.fc(),e=d.qc(2);d.Bb(4),d.Ic("No.",null==t._data?null:t._data.no,""),d.Bb(4),d.Jc(" ",d.hc(9,6,"MANAGE.SCRIPTS.OPTION_NAME"),"\uff1a ",d.hc(10,8,null==t._data?null:t._data.stepName)," "),d.Bb(5),d.Ic("",d.hc(14,10,"MANAGE.SCRIPTS.PARAMS"),"\uff1a"),d.Bb(2),d.kc("ngForOf",null==t._data?null:t._data.params),d.Bb(1),d.kc("matMenuTriggerFor",e)}}let he=(()=>{class t{constructor(t,e,n){this._dialog=t,this.cacheService=e,this._el=n,this.trigger=new d.o,this._data={no:0,stepName:"",params:[]}}ngOnInit(){this.updateData(this.step)}ngOnChanges(t){const{step:e}=t;e&&!e.isFirstChange&&this.updateData(e.currentValue)}triggerAction(t){this.trigger.emit(t)}openScriptStepEditDialog(t){this._dialog.open(o.g,{data:{scriptStep:t,session:this.session,scriptCmdOpt:this.scriptCmdOpt}})}updateData(t){this._data.no=this.addZore(t.number+1),this._data.stepName=this.getStepName(t.code),this._data.params=this.createParams()}createParams(){return this.scriptCmdOpt.mode.find(t=>t.code===this.step.code).values.filter(de).map(be).map((t,e)=>{const n=this.step.values[e],i=a.h[t];let c={type:i,name:""};switch(i){case"Param":c.name=n;break;case"Multi":c.name=this.getMultiOpt(n);break;case"Common":c.name=this.getCommonOptName(n);break;case"Color":c.name=this.getRgbString(this.step.values);break;default:const i=this.cacheService.getAssets(t);c.name=1===i.data.length?i.data[0].name:function(t,e){const n=t.data.find(t=>t.code===e);return n?n.name:"null"}(i,this.step.values[e])}return c})}getStepName(t){const e=this.scriptCmdOpt.mode.find(e=>e.code===t);return e?e.name:"None"}getMultiOpt(t){return Object(r.o)(Object(r.i)(t,a.t))}getCommonOptName(t){const e=a.r.find(e=>e.code===t);return e?e.name:"None"}getRgbString(t){return`rgb(${t[0]},${t[1]},${t[2]})`}addZore(t){return t<10&&t>0?"000"+t:t<100&&t>=10?"00"+t:t<1e3&&t>=100?"0"+t:t}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(b.b),d.Nb(g.a),d.Nb(d.l))},t.\u0275cmp=d.Hb({type:t,selectors:[["script-step"]],inputs:{step:"step",session:"session",scriptCmdOpt:"scriptCmdOpt"},outputs:{trigger:"trigger"},features:[d.zb],decls:21,vars:10,consts:[[4,"ngIf"],["menu","matMenu"],["mat-menu-item","",3,"click"],[1,"step-card"],[1,"step-wrapper",3,"click"],[1,"step-card-no"],[1,"step-body-wrapper"],[1,"step-title"],[1,"step-name"],[1,"step-param"],[1,"label"],["class","step-box",4,"ngFor","ngForOf"],[1,"action-icon",3,"matMenuTriggerFor"],[1,"step-box"],[3,"ngSwitch"],[4,"ngSwitchCase"],["class","color",3,"backgroundColor",4,"ngSwitchCase"],[1,"color"]],template:function(t,e){1&t&&(d.Ec(0,pe,18,12,"ng-container",0),d.Tb(1,"mat-menu",null,1),d.Tb(3,"button",2),d.bc("click",function(){return e.triggerAction("insertBefore")}),d.Tb(4,"mat-icon"),d.Gc(5,"arrow_drop_up"),d.Sb(),d.Tb(6,"span"),d.Gc(7),d.gc(8,"translate"),d.Sb(),d.Sb(),d.Tb(9,"button",2),d.bc("click",function(){return e.triggerAction("insertAfter")}),d.Tb(10,"mat-icon"),d.Gc(11,"arrow_drop_down"),d.Sb(),d.Tb(12,"span"),d.Gc(13),d.gc(14,"translate"),d.Sb(),d.Sb(),d.Tb(15,"button",2),d.bc("click",function(){return e.triggerAction("deleteStep")}),d.Tb(16,"mat-icon"),d.Gc(17,"delete"),d.Sb(),d.Tb(18,"span"),d.Gc(19),d.gc(20,"translate"),d.Sb(),d.Sb(),d.Sb()),2&t&&(d.kc("ngIf",e._data),d.Bb(7),d.Hc(d.hc(8,4,"MANAGE.SCRIPTS.INSERT_BEFORE")),d.Bb(6),d.Hc(d.hc(14,6,"MANAGE.SCRIPTS.INSERT_AFTER")),d.Bb(6),d.Hc(d.hc(20,8,"MANAGE.SCRIPTS.DELETE_STEP")))},directives:[j.k,ie.a,ie.b,D.a,j.j,ie.d,j.m,j.n],pipes:[R.c],styles:[".step-card[_ngcontent-%COMP%]{position:relative;padding:8px 1rem 8px 0;font-size:12px}.step-card[_ngcontent-%COMP%]   .step-wrapper[_ngcontent-%COMP%]{display:flex;cursor:pointer}.step-card[_ngcontent-%COMP%]   .step-wrapper[_ngcontent-%COMP%]   .step-card-no[_ngcontent-%COMP%]{flex:0 1 90px;font-family:monospace}.step-card[_ngcontent-%COMP%]   .step-wrapper[_ngcontent-%COMP%]   .step-body-wrapper[_ngcontent-%COMP%]   .step-param[_ngcontent-%COMP%]{display:flex;flex:1;padding:2px 0}.step-card[_ngcontent-%COMP%]   .step-wrapper[_ngcontent-%COMP%]   .step-body-wrapper[_ngcontent-%COMP%]   .step-param[_ngcontent-%COMP%]   .step-box[_ngcontent-%COMP%]{margin:4px 1rem;color:#c2185b}.step-card[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{display:none;position:absolute;right:1rem;top:50%;transform:translateY(-50%)}.step-card[_ngcontent-%COMP%]:hover   .action-icon[_ngcontent-%COMP%]{display:block}.color[_ngcontent-%COMP%]{width:1rem;height:1rem}"]}),t})();const de=t=>"no_more.json"!==t,be=t=>t.replace(".json","");function ue(t,e){if(1&t&&(d.Tb(0,"mat-option",14),d.Gc(1),d.gc(2,"translate"),d.Sb()),2&t){const t=e.$implicit,n=d.fc();d.kc("value",t.number),d.Bb(1),d.Jc(" No.",t.number+1," - ",d.hc(2,3,n.getScriptName(t))," ")}}function ge(t,e){if(1&t){const t=d.Ub();d.Tb(0,"script-step",15),d.bc("trigger",function(n){d.tc(t);const i=e.index;return d.fc().handleStepTrigger(n,i)}),d.Sb()}if(2&t){const t=e.$implicit,n=d.fc();d.kc("step",t)("session",n.session)("scriptCmdOpt",n.scriptCmdOpt)}}let me=(()=>{class t{constructor(t,e,n,i,c,s,o){this.deviceService=t,this.scriptService=e,this.loadService=n,this.cacheService=i,this.authService=c,this.router=s,this._dialog=o,this.stepList=[],this.pageSize=100,this.pageIndex=0,this.pageSizeOptions=[10,50,100],this.destory$=new h.a,t.device$.pipe(Object(p.a)(this.destory$)).subscribe(t=>{t&&(this.session=t.session,this.scriptCmdOpt=i.getAssetsByMain(a.d.ScriptEdit))})}ngOnInit(){return Object(s.a)(this,void 0,void 0,function*(){this.loadService.loading();const t=yield this.getScripts();this.handleScriptsUpdate(t.data);const e=yield this.getStepList();this.handleStepListUpdata(e.data),this.scriptService.stepUpdate$.pipe(Object(p.a)(this.destory$)).subscribe(()=>Object(s.a)(this,void 0,void 0,function*(){const t=yield this.getStepList();this.handleStepListUpdata(t.data)}))})}clearAllStep(){this._dialog.open(Vt.a,{data:{content:"WARN.CLEAR_ALL_STEP"}}).afterClosed().subscribe(({success:t})=>Object(s.a)(this,void 0,void 0,function*(){if(t){this.loadService.loading();let t=[];for(let n=0;n<=8;n++)t.push({code:255,number:0,values:[0,0,0,0]});yield this.scriptService.writeScriptSteps(this.session,[...t]).toPromise();let e=this.scriptNo===this.scripts.length?this.scriptNo-1:this.scriptNo+1;yield this.scriptService.switchScript(this.session,[this.findScriptByNumber(e)]).toPromise(),this.switchScript(this.findScriptByNumber())}}))}clearByRange(){this._dialog.open(Yt.a,{data:{min:1,max:r.a}}).afterClosed().subscribe(({start:t,end:e})=>{if(t&&e){t-=1,e-=1;let n=[],i=0;this.stepListCache.forEach(function(c,s){(s<t||s>e)&&(n[i]=c,n[i].number=i,i++)}),this.writeStepList(n)}})}resetDelay(){this._dialog.open(Zt.a,{data:35}).afterClosed().subscribe(t=>{if(t>0&&t<255){let e=[];for(let n=0;n<this.stepListCache.length;n++){const i=this.stepListCache[n];if(5===i.code)if(i.code=6,i.values[0]=t,e.length>0){const t=e[e.length-1].code;5===t||6===t||e.push(i)}else e.push(i);else if(6===i.code)if(i.values[0]=t,e.length>0){const t=e[e.length-1].code;5===t||6===t||e.push(i)}else e.push(i);else e.push(i)}for(let t=0;t<e.length;t++)e[t].number=t;this.writeStepList(e)}})}openInsertScript(t){this._dialog.open(Wt.a,{data:{title:"before"===t?"MANAGE.SCRIPTS.INSERT_BEFORE_LIST":"MANAGE.SCRIPTS.INSERT_AFTER_LIST"}}).afterClosed().subscribe(e=>{e&&this.handleStepTrigger("before"===t?"insertListBefore":"insertListAfter",e.order-1,e.scripts)})}handleStepTrigger(t,e,n=[r.g]){const{pageIndex:i,pageSize:c,stepListCache:s}=this,o=i*c+e,a=s.slice(0,o),l=s.slice(o,o+1),p=s.slice(o+1);let h=[];switch(t){case"insertBefore":case"insertListBefore":h=[...a,...n,...l,...p];break;case"insertAfter":case"insertListAfter":h=[...a,...l,...n,...p];break;case"deleteStep":h=[...a,...p]}h=h.slice(0,r.a).map(r.k),this.writeStepList(h),0!==e&&(e+1)%c==0&&(this.pageIndex++,this.onPageChange(this.pageIndex,this.pageSize))}uploadScript(t){return Object(s.a)(this,void 0,void 0,function*(){let e=Object(r.l)(r.a);const n=yield Object(r.t)(t[0]);JSON.parse(n).filter(r.e).forEach((t,n)=>{const i=Object(r.f)(this.scriptCmdOpt.mode,t.code);e[n]=i?Object.assign(t):Object.assign(Object.assign({},t),{code:0})}),this.writeStepList(e)})}saveToJson(){this._dialog.open(o.c,{data:a.g}).afterClosed().subscribe(t=>{if(t){const e=this.stepListCache.filter(r.e);Object(r.h)(e,t.content)}})}onScriptChange(){this.pageIndex=0,this.switchScript(this.findScriptByNumber())}openRenameDialog(){const{values:[t],number:e}=this.findScriptByNumber();this._dialog.open(o.c,{data:Object.assign(Object.assign({},a.j),{content:t})}).afterClosed().subscribe(t=>{t&&this.renameSript({number:e,code:1,values:[t.content]})})}onPageChange(t,e){this.pageIndex=t,this.pageSize=e,this.updateDataSource()}getScriptName(t){return""===t.values[0]?"\u672a\u547d\u540d":t.values[0]}toSettingPage(){this.authService.updateUrl(this.router.url,"/setting/record")}updateDataSource(){const t=this.pageIndex*this.pageSize;this.stepList=this.stepListCache.slice(t,t+this.pageSize),this.loadService.complete()}writeStepList(t){return Object(s.a)(this,void 0,void 0,function*(){this.loadService.loading(),yield this.scriptService.writeScriptSteps(this.session,[...t]).toPromise();const{data:e}=yield this.getStepList();this.handleStepListUpdata(e)})}handleScriptsUpdate(t){return Object(s.a)(this,void 0,void 0,function*(){this.scripts=[...t],this.scriptNo=this.scripts.find(t=>1===t.code).number,this.loadService.complete()})}handleStepListUpdata(t){this.stepListCache=[...t],this.updateDataSource()}getScripts(){return this.scriptService.getScripts(this.session).toPromise()}getStepList(){return this.scriptService.getScriptsSteps(this.session).toPromise()}switchScript(t){return Object(s.a)(this,void 0,void 0,function*(){this.loadService.loading();const e=Object.assign(Object.assign({},t),{code:1});yield this.scriptService.switchScript(this.session,[e]).toPromise(),this.scriptNo=t.number;const n=yield this.getStepList();this.handleStepListUpdata(n.data)})}findScriptByNumber(t=this.scriptNo){return this.scripts.find(e=>e.number===t)}renameSript(t){return Object(s.a)(this,void 0,void 0,function*(){this.loadService.loading(),yield this.scriptService.renameByScript(this.session,[t]).toPromise();const e=yield this.getScripts();this.handleScriptsUpdate(e.data)})}ngOnDestroy(){this.destory$.next(),this.destory$.complete()}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(m.a),d.Nb(T.a),d.Nb(f.a),d.Nb(g.a),d.Nb(S.a),d.Nb(c.c),d.Nb(b.b))},t.\u0275cmp=d.Hb({type:t,selectors:[["ng-component"]],decls:39,vars:31,consts:[[1,"script-manage-container"],[3,"ngModel","placeholder","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"script-action"],[1,"export-file","link",3,"click"],[1,"import-file","link",3,"click"],["accept","application/json","type","file",1,"file-input",3,"change"],["fileInput",""],[1,"rename","link",3,"click"],[1,"steps-container"],[3,"step","session","scriptCmdOpt","trigger",4,"ngFor","ngForOf"],[3,"pageIndex","length","pageSize","pageSizeOptions","page"],[1,"step-operation-wrapper"],[1,"operation-item",3,"click"],[3,"value"],[3,"step","session","scriptCmdOpt","trigger"]],template:function(t,e){if(1&t){const t=d.Ub();d.Tb(0,"div",0),d.Tb(1,"mat-form-field"),d.Tb(2,"mat-select",1),d.bc("ngModelChange",function(t){return e.scriptNo=t})("selectionChange",function(){return e.onScriptChange()}),d.gc(3,"translate"),d.Ec(4,ue,3,5,"mat-option",2),d.Sb(),d.Sb(),d.Tb(5,"div",3),d.Tb(6,"div",4),d.bc("click",function(){return e.toSettingPage()}),d.Gc(7),d.gc(8,"translate"),d.Sb(),d.Tb(9,"div",5),d.bc("click",function(){return d.tc(t),d.qc(11).click()}),d.Tb(10,"input",6,7),d.bc("change",function(){d.tc(t);const n=d.qc(11);return e.uploadScript(n.files),n.value=null}),d.Sb(),d.Gc(12),d.gc(13,"translate"),d.Sb(),d.Tb(14,"div",4),d.bc("click",function(){return e.saveToJson()}),d.Gc(15),d.gc(16,"translate"),d.Sb(),d.Tb(17,"div",8),d.bc("click",function(){return e.openRenameDialog()}),d.Gc(18),d.gc(19,"translate"),d.Sb(),d.Sb(),d.Tb(20,"div",9),d.Ec(21,ge,1,3,"script-step",10),d.Sb(),d.Tb(22,"mat-paginator",11),d.bc("page",function(t){return e.onPageChange(t.pageIndex,t.pageSize)}),d.Sb(),d.Tb(23,"div",12),d.Tb(24,"div",13),d.bc("click",function(){return e.clearAllStep()}),d.Gc(25),d.gc(26,"translate"),d.Sb(),d.Tb(27,"div",13),d.bc("click",function(){return e.clearByRange()}),d.Gc(28),d.gc(29,"translate"),d.Sb(),d.Ob(30,"mat-divider"),d.Tb(31,"div",13),d.bc("click",function(){return e.resetDelay()}),d.Gc(32),d.gc(33,"translate"),d.Sb(),d.Ob(34,"mat-divider"),d.Tb(35,"div",13),d.bc("click",function(){return e.openInsertScript("before")}),d.Gc(36," \u5728\u4e4b\u524d\u63d2\u5165 "),d.Sb(),d.Tb(37,"div",13),d.bc("click",function(){return e.openInsertScript("after")}),d.Gc(38," \u5728\u4e4b\u540e\u63d2\u5165 "),d.Sb(),d.Sb(),d.Sb()}2&t&&(d.Bb(2),d.lc("placeholder",d.hc(3,15,"MANAGE.SCRIPTS.CO_SCRIPT")),d.kc("ngModel",e.scriptNo),d.Bb(2),d.kc("ngForOf",e.scripts),d.Bb(3),d.Ic(" ",d.hc(8,17,"SETTING.RECORD")," "),d.Bb(5),d.Ic(" ",d.hc(13,19,"MANAGE.SCRIPTS.IMPORT")," "),d.Bb(3),d.Ic(" ",d.hc(16,21,"MANAGE.SCRIPTS.EXPORT")," "),d.Bb(3),d.Ic(" ",d.hc(19,23,"MANAGE.SCRIPTS.RENAME_SC")," "),d.Bb(3),d.kc("ngForOf",e.stepList),d.Bb(1),d.kc("pageIndex",e.pageIndex)("length",null==e.stepListCache?null:e.stepListCache.length)("pageSize",e.pageSize)("pageSizeOptions",e.pageSizeOptions),d.Bb(3),d.Ic(" ",d.hc(26,25,"MANAGE.SCRIPTS.CLEAR_ALL_STEP")," "),d.Bb(3),d.Ic(" ",d.hc(29,27,"MANAGE.SCRIPTS.CLEAR_RANGE_STEP")," "),d.Bb(4),d.Ic(" ",d.hc(33,29,"MANAGE.SCRIPTS.RESET_DELAY")," "))},directives:[ht.b,dt.a,te.l,te.n,j.j,ee.a,ne.a,bt.l,he],pipes:[R.c],styles:[".script-manage-container[_ngcontent-%COMP%]{position:relative;width:55%;margin:0 auto;padding-top:2rem}.script-manage-container[_ngcontent-%COMP%]   .script-action[_ngcontent-%COMP%]{position:absolute;display:flex;right:0;top:5.5rem;font-size:.75rem;color:#c2185b;z-index:10}.script-manage-container[_ngcontent-%COMP%]   .script-action[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{margin:0 .5rem}.script-manage-container[_ngcontent-%COMP%]   .script-action[_ngcontent-%COMP%]   .import-file[_ngcontent-%COMP%]{position:relative;overflow:hidden}.script-manage-container[_ngcontent-%COMP%]   .script-action[_ngcontent-%COMP%]   .import-file[_ngcontent-%COMP%]   .file-input[_ngcontent-%COMP%]{visibility:hidden;position:absolute;width:100%;height:100%}.script-manage-container[_ngcontent-%COMP%]   .steps-container[_ngcontent-%COMP%]{height:37.5rem;overflow:auto;margin-top:1rem}.script-manage-container[_ngcontent-%COMP%]   .step-operation-wrapper[_ngcontent-%COMP%]{position:absolute;right:-200px;top:9rem}.script-manage-container[_ngcontent-%COMP%]   .step-operation-wrapper[_ngcontent-%COMP%]   .operation-item[_ngcontent-%COMP%]{cursor:pointer;font-size:12px;color:#aaa;padding:4px 0}.script-manage-container[_ngcontent-%COMP%]   .step-operation-wrapper[_ngcontent-%COMP%]   .operation-item[_ngcontent-%COMP%]:hover{color:#fff}.script-manage-container[_ngcontent-%COMP%]   .step-operation-wrapper[_ngcontent-%COMP%]   .mat-divider[_ngcontent-%COMP%]{margin:1rem 0}"]}),t})();var fe=n("cnJX"),Se=n("UXJo"),ve=n("+0xr");function Oe(t,e){if(1&t){const t=d.Ub();d.Tb(0,"div",14),d.Tb(1,"div",15),d.Gc(2),d.gc(3,"translate"),d.Sb(),d.Tb(4,"button",16),d.bc("click",function(){return d.tc(t),d.fc().onStringTypeChange("GBK")}),d.Gc(5," GBK "),d.Sb(),d.Tb(6,"button",16),d.bc("click",function(){return d.tc(t),d.fc().onStringTypeChange("Unicode")}),d.Gc(7," Unicode "),d.Sb(),d.Sb()}if(2&t){const t=d.fc();d.Bb(2),d.Ic("",d.hc(3,3,"MANAGE.STRINGS.SW_ENCODE"),"\uff1a"),d.Bb(2),d.kc("color","GBK"===t.stringType?"primary":""),d.Bb(2),d.kc("color","Unicode"===t.stringType?"primary":"")}}function Ce(t,e){1&t&&(d.Tb(0,"th",17),d.Gc(1),d.gc(2,"translate"),d.Sb()),2&t&&(d.Bb(1),d.Ic(" ",d.hc(2,1,"MANAGE.STRINGS.TABLE_NO")," "))}function ye(t,e){if(1&t&&(d.Tb(0,"td",18),d.Gc(1),d.Sb()),2&t){const t=e.$implicit;d.Bb(1),d.Ic(" ",(null==t?null:t.number)+1," ")}}function ke(t,e){1&t&&(d.Tb(0,"th",17),d.Gc(1),d.gc(2,"translate"),d.Sb()),2&t&&(d.Bb(1),d.Ic(" ",d.hc(2,1,"MANAGE.STRINGS.TABLE_CONTENT")," "))}function Pe(t,e){if(1&t&&(d.Tb(0,"td",19),d.Gc(1),d.Sb()),2&t){const t=e.$implicit;d.Bb(1),d.Ic(" ",null==t?null:t.values[0]," ")}}function Te(t,e){1&t&&(d.Tb(0,"th",17),d.Gc(1),d.gc(2,"translate"),d.Sb()),2&t&&(d.Bb(1),d.Ic(" ",d.hc(2,1,"MANAGE.STRINGS.TABLE_OPERATION")," "))}function we(t,e){if(1&t){const t=d.Ub();d.Tb(0,"td",20),d.Tb(1,"mat-icon",21),d.bc("click",function(){d.tc(t);const n=e.$implicit;return d.fc().copy(null==n?null:n.values[0])}),d.gc(2,"translate"),d.Gc(3," content_copy "),d.Sb(),d.Tb(4,"mat-icon",21),d.bc("click",function(){d.tc(t);const n=e.$implicit;return d.fc().edit(null==n?null:n.number,null==n?null:n.values[0])}),d.gc(5,"translate"),d.Gc(6," create "),d.Sb(),d.Tb(7,"mat-icon",21),d.bc("click",function(){d.tc(t);const n=e.$implicit;return d.fc().reset(null==n?null:n.number)}),d.gc(8,"translate"),d.Gc(9," clear "),d.Sb(),d.Sb()}2&t&&(d.Bb(1),d.kc("matTooltip",d.hc(2,3,"COMMON.COPY")),d.Bb(3),d.kc("matTooltip",d.hc(5,5,"COMMON.EDIT")),d.Bb(3),d.kc("matTooltip",d.hc(8,7,"COMMON.CLEAR")))}function Me(t,e){1&t&&d.Ob(0,"tr",22)}function _e(t,e){1&t&&d.Ob(0,"tr",23)}let Be=(()=>{class t{constructor(t,e,n,i,c,s,o,a){switch(this.router=t,this.deviceService=e,this._clipboard=n,this._snackBar=i,this._dialog=c,this.pwdService=s,this.stringService=o,this.loadService=a,this.stringType="GBK",this.displayedColumns=["id","content","operation"],this.dataSource=[],this.cacheData=[],this.pageIndex=0,this.pageSize=10,this.destory$=new h.a,this.mode=t.routeConfig.path,e.device$.pipe(Object(p.a)(this.destory$)).subscribe(t=>{t&&(this.session=t.session)}),this.mode){case"password":this.getPasswordData();break;case"strings":this.getStringsData(this.stringType)}}ngOnInit(){}onStringTypeChange(t){t!==this.stringType&&(this.stringType=t,this.getStringsData(t))}copy(t){this._clipboard.copy(t),this._snackBar.open("Copy Success To Clipboard!")}edit(t,e){switch(this.mode){case"password":this.openEditByPwd(t,e);break;case"strings":this.openEditByString(t,e)}}reset(t){this._dialog.open(Vt.a,{data:{title:"TITLE.RESET",content:"WARN.CONFIRM_RESET"}}).afterClosed().subscribe(e=>{(null==e?void 0:e.success)&&this.write(t,"")})}onPageChange(t){this.pageIndex=t,this.updateDataSource()}write(t,e){this.loadService.loading();const n=this.cacheData.find(e=>e.number===t);"password"===this.mode&&this.handlePwdWrite(e,n),"strings"===this.mode&&"GBK"===this.stringType&&this.handleGbkWrite(e,n),"strings"===this.mode&&"Unicode"===this.stringType&&this.handleUnicodeWrite(e,n)}handlePwdWrite(t,e){e.values[0]=t,this.pwdService.update(this.session,[e]).pipe(Object(p.a)(this.destory$)).subscribe(t=>{this.cacheData=Object(r.j)(this.cacheData,t.data[0]),this.updateDataSource()})}handleGbkWrite(t,e){e.values[0]=t,this.stringService.writeByGbk(this.session,[e]).pipe(Object(p.a)(this.destory$)).subscribe(t=>{this.cacheData=Object(r.j)(this.cacheData,e),this.updateDataSource()})}handleUnicodeWrite(t,e){e.values=new Array(56).fill(0);for(let n=0;n<t.length;n++){const i=Object(r.b)(t.charCodeAt(n));e.values[2*n]=i.low,e.values[2*n+1]=i.high}this.stringService.writeByUnicode(this.session,[e]).pipe(Object(p.a)(this.destory$)).subscribe(t=>{let n=Object.assign(Object.assign({},e),{values:[Object(r.w)(e.values)]});this.cacheData=Object(r.j)(this.cacheData,n),this.updateDataSource()})}updateDataSource(){this.dataSource=this.cacheData.slice(this.pageIndex*this.pageSize,this.pageIndex*this.pageSize+this.pageSize),this.loadService.complete()}getPasswordData(){this.loadService.loading(),this.pwdService.getPwdList(this.session).pipe(Object(p.a)(this.destory$)).subscribe(t=>{this.cacheData=t.data,this.updateDataSource()})}getStringsData(t){switch(this.loadService.loading(),t){case"GBK":this.stringService.getDataByGbk(this.session).pipe(Object(p.a)(this.destory$)).subscribe(t=>{this.cacheData=t.data,this.updateDataSource()});break;case"Unicode":this.stringService.getDataByUnicode(this.session).pipe(Object(p.a)(this.destory$)).subscribe(t=>{this.cacheData=t.data.map(t=>Object.assign(Object.assign({},t),{values:[Object(r.w)(t.values)]})),this.updateDataSource()})}}openEditByString(t,e){this._dialog.open(fe.a,{data:{content:e,maxLength:a.l,title:"TITLE.STRING"}}).afterClosed().subscribe(e=>{(null==e?void 0:e.success)&&this.write(t,e.content)})}openEditByPwd(t,e){this._dialog.open(fe.a,{data:{content:e,maxLength:29,title:"TITLE.PWD",warn:"WARN.PWD_INPUT"}}).afterClosed().subscribe(e=>{(null==e?void 0:e.success)&&this.write(t,e.content)})}ngOnDestroy(){this.destory$.next(),this.destory$.complete()}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(c.a),d.Nb(m.a),d.Nb(Se.a),d.Nb(u.b),d.Nb(b.b),d.Nb(P),d.Nb(w),d.Nb(f.a))},t.\u0275cmp=d.Hb({type:t,selectors:[["ng-component"]],decls:16,vars:6,consts:[[1,"strings-manage-container"],["class","strings-type",4,"ngIf"],[1,"strings-manage-box"],["mat-table","",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","order",4,"matCellDef"],["matColumnDef","content"],["mat-cell","",4,"matCellDef"],["matColumnDef","operation"],["mat-cell","","class","operation",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["hidePageSize","",3,"length","pageSize","page"],[1,"strings-type"],[1,"label"],["mat-raised-button","",3,"color","click"],["mat-header-cell",""],["mat-cell","",1,"order"],["mat-cell",""],["mat-cell","",1,"operation"],["matTooltipPosition","above",1,"link",3,"matTooltip","click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(d.Tb(0,"div",0),d.Ec(1,Oe,8,5,"div",1),d.Tb(2,"div",2),d.Tb(3,"table",3),d.Rb(4,4),d.Ec(5,Ce,3,3,"th",5),d.Ec(6,ye,2,1,"td",6),d.Qb(),d.Rb(7,7),d.Ec(8,ke,3,3,"th",5),d.Ec(9,Pe,2,1,"td",8),d.Qb(),d.Rb(10,9),d.Ec(11,Te,3,3,"th",5),d.Ec(12,we,10,9,"td",10),d.Qb(),d.Ec(13,Me,1,0,"tr",11),d.Ec(14,_e,1,0,"tr",12),d.Sb(),d.Tb(15,"mat-paginator",13),d.bc("page",function(t){return e.onPageChange(t.pageIndex)}),d.Sb(),d.Sb(),d.Sb()),2&t&&(d.Bb(1),d.kc("ngIf","strings"===e.mode),d.Bb(2),d.kc("dataSource",e.dataSource),d.Bb(10),d.kc("matHeaderRowDef",e.displayedColumns),d.Bb(1),d.kc("matRowDefColumns",e.displayedColumns),d.Bb(1),d.kc("length",null==e.cacheData?null:e.cacheData.length)("pageSize",e.pageSize))},directives:[j.k,ve.j,ve.c,ve.e,ve.b,ve.g,ve.i,ee.a,x.a,ve.d,ve.a,D.a,X.a,ve.f,ve.h],pipes:[R.c],styles:[".strings-manage-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;position:relative;width:56.25rem;margin:0 auto;height:100%;padding:2rem 0}.strings-manage-box[_ngcontent-%COMP%]{width:100%;box-shadow:0 1px 5px #202428}.operation[_ngcontent-%COMP%]{width:8rem}.operation[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:.5rem}.operation[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]:hover{color:#c2185b}.order[_ngcontent-%COMP%]{width:6.25rem}.strings-type[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:2rem}.strings-type[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{margin-right:1rem}"]}),t})();var Ne=n("5RNC");let xe=(()=>{class t{constructor(){this.valueChange=new d.o,this.value=0}ngOnChanges(t){const{config:e}=t;e&&(this.value=e.currentValue.values[1])}changeValue(t){const{number:e,values:n}=this.config;n[1]=t,this.valueChange.emit({code:0,number:e,values:n})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=d.Hb({type:t,selectors:[["touch-ctrl"]],inputs:{config:"config"},outputs:{valueChange:"valueChange"},features:[d.zb],decls:7,vars:6,consts:[[1,"touch-ctrl-wrapper"],[1,"header"],[1,"no"],[1,"value"],["color","accent","thumbLabel","",3,"max","min","step","ngModel","ngModelChange","change"]],template:function(t,e){1&t&&(d.Tb(0,"div",0),d.Tb(1,"div",1),d.Tb(2,"div",2),d.Gc(3),d.Sb(),d.Tb(4,"div",3),d.Gc(5),d.Sb(),d.Sb(),d.Tb(6,"mat-slider",4),d.bc("ngModelChange",function(t){return e.value=t})("change",function(t){return e.changeValue(t.value)}),d.Sb(),d.Sb()),2&t&&(d.Bb(3),d.Ic("No. ",(null==e.config?null:e.config.number)+1,""),d.Bb(2),d.Hc(e.value),d.Bb(1),d.kc("max",255)("min",0)("step",1)("ngModel",e.value))},directives:[Ne.a,te.l,te.n],styles:["mat-slider[_ngcontent-%COMP%]{width:100%}.touch-ctrl-wrapper[_ngcontent-%COMP%]{margin-bottom:3rem}.header[_ngcontent-%COMP%]{padding:0 8px;display:flex;align-items:center;justify-content:space-between}.header[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#c2185b}"]}),t})();function je(t,e){if(1&t){const t=d.Ub();d.Tb(0,"touch-ctrl",2),d.bc("valueChange",function(e){return d.tc(t),d.fc().handleTouchCtrlChange(e)}),d.Sb()}2&t&&d.kc("config",e.$implicit)}const Ee=[{path:"",component:Ht,children:[{path:"",redirectTo:"keyboard"},{path:"keyboard",component:pt},{path:"keyboard-old",component:ot},{path:"lights",component:Ft},{path:"scripts",component:me},{path:"color-palette",component:nt},{path:"metaInfo",component:qt},{path:"password",component:Be},{path:"strings",component:Be},{path:"optionByte",component:Xt},{path:"backup",component:q},{path:"touch",component:(()=>{class t{constructor(t,e,n){this.deviceService=t,this.loadService=e,this.touchService=n,this.destory$=new h.a,t.device$.pipe(Object(p.a)(this.destory$)).subscribe(t=>{t&&(this.session=t.session)}),this.getTouchSensitivity(this.session)}handleTouchCtrlChange(t){this.loadService.loading(),this.touchService.setToucchSensitivity(this.session,[t]).pipe(Object(p.a)(this.destory$)).subscribe(()=>{this.dataSource=Object(r.j)(this.dataSource,t),this.loadService.complete()})}getTouchSensitivity(t){this.loadService.loading(),this.touchService.getTouchSensitivity(t).pipe(Object(p.a)(this.destory$)).subscribe(t=>{this.dataSource=t.data,this.loadService.complete()})}ngOnDestroy(){this.destory$.next(),this.destory$.complete()}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(m.a),d.Nb(f.a),d.Nb(M))},t.\u0275cmp=d.Hb({type:t,selectors:[["ng-component"]],decls:2,vars:1,consts:[[1,"page-wrapper"],[3,"config","valueChange",4,"ngFor","ngForOf"],[3,"config","valueChange"]],template:function(t,e){1&t&&(d.Tb(0,"div",0),d.Ec(1,je,1,1,"touch-ctrl",1),d.Sb()),2&t&&(d.Bb(1),d.kc("ngForOf",e.dataSource))},directives:[j.j,xe],styles:[".page-wrapper[_ngcontent-%COMP%]{width:900px;margin:auto;padding:3rem 0;max-height:800px;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;overflow:auto}touch-ctrl[_ngcontent-%COMP%]{width:100%}"]}),t})()}]}];let Ie=(()=>{class t{}return t.\u0275mod=d.Lb({type:t}),t.\u0275inj=d.Kb({factory:function(e){return new(e||t)},imports:[[c.f.forChild(Ee)],c.f]}),t})(),Ge=(()=>{class t{}return t.\u0275mod=d.Lb({type:t}),t.\u0275inj=d.Kb({factory:function(e){return new(e||t)},imports:[[i.a,Ie]]}),t})();d.wc(o.a,[It,j.j,x.a,b.d],[R.c]),d.wc(o.e,[It,j.j,x.a,b.d],[R.c]),d.wc(o.g,[It,j.j,x.a,b.d],[R.c])}}]);