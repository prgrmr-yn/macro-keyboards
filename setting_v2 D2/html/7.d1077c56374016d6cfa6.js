(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{oK7c:function(t,e,n){"use strict";n.r(e),n.d(e,"SettingModule",function(){return z});var i=n("ADsi"),o=n("tyNb"),c=n("fXoL");let r=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Hb({type:t,selectors:[["ng-component"]],decls:2,vars:0,template:function(t,e){1&t&&(c.Tb(0,"div"),c.Gc(1," \u653e\u4ec0\u4e48\uff1f\n"),c.Sb())},styles:[""]}),t})();var a=n("mkZv"),s=n("YMfE"),l=n("sYmb"),p=n("kmnG"),b=n("d3UM"),g=n("3Pt+"),d=n("ofXK"),u=n("qFsG"),h=n("QibW"),m=n("FKr1");function f(t,e){if(1&t&&(c.Tb(0,"mat-option",9),c.Gc(1),c.Sb()),2&t){const t=e.$implicit;c.kc("value",t.key),c.Bb(1),c.Ic(" ",t.value," ")}}let v=(()=>{class t{constructor(t){this.translate=t,this.isOpenDelay=localStorage.getItem("isOpenDelay")||"close",this.delay=Number(localStorage.getItem("delay"))||35,this.langSelected=Object(s.n)(),this.langOption=a.m}selectLang(t){Object(s.v)(t),this.translate.use(t)}changeDelay(){this.delay>255?this.delay=255:this.delay<0&&(this.delay=0),localStorage.setItem("delay",this.delay.toString())}changeDelayOpen(){localStorage.setItem("isOpenDelay",this.isOpenDelay)}}return t.\u0275fac=function(e){return new(e||t)(c.Nb(l.d))},t.\u0275cmp=c.Hb({type:t,selectors:[["ng-component"]],decls:18,vars:10,consts:[[1,"option-box"],[1,"label"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"delay-container"],[1,"delay"],["matInput","","type","number","min","0","max","255","placeholder","Record Delay",3,"ngModel","ngModelChange"],["value","open"],["value","close"],[3,"value"]],template:function(t,e){1&t&&(c.Tb(0,"div",0),c.Tb(1,"div",1),c.Gc(2),c.gc(3,"translate"),c.Sb(),c.Tb(4,"mat-form-field"),c.Tb(5,"mat-select",2),c.bc("ngModelChange",function(t){return e.langSelected=t})("ngModelChange",function(t){return e.selectLang(t)}),c.Ec(6,f,2,2,"mat-option",3),c.Sb(),c.Sb(),c.Tb(7,"div",1),c.Gc(8),c.gc(9,"translate"),c.Sb(),c.Tb(10,"div",4),c.Tb(11,"mat-form-field",5),c.Tb(12,"input",6),c.bc("ngModelChange",function(t){return e.delay=t})("ngModelChange",function(){return e.changeDelay()}),c.Sb(),c.Sb(),c.Tb(13,"mat-radio-group",2),c.bc("ngModelChange",function(t){return e.isOpenDelay=t})("ngModelChange",function(){return e.changeDelayOpen()}),c.Tb(14,"mat-radio-button",7),c.Gc(15,"Open"),c.Sb(),c.Tb(16,"mat-radio-button",8),c.Gc(17,"Close"),c.Sb(),c.Sb(),c.Sb(),c.Sb()),2&t&&(c.Bb(2),c.Ic(" ",c.hc(3,6,"SETTING.SW_LANG")," "),c.Bb(3),c.kc("ngModel",e.langSelected),c.Bb(1),c.kc("ngForOf",e.langOption),c.Bb(2),c.Ic(" ",c.hc(9,8,"SETTING.DELAY")," "),c.Bb(4),c.kc("ngModel",e.delay),c.Bb(1),c.kc("ngModel",e.isOpenDelay))},directives:[p.b,b.a,g.l,g.n,d.j,u.b,g.o,g.c,h.b,h.a,m.l],pipes:[l.c],styles:[".option-box[_ngcontent-%COMP%]{margin-bottom:1rem}.delay-container[_ngcontent-%COMP%]{padding-top:4px}.delay-container[_ngcontent-%COMP%]   mat-radio-button[_ngcontent-%COMP%]{margin-left:16px}.delay-container[_ngcontent-%COMP%]   .delay[_ngcontent-%COMP%]{width:160px}"]}),t})();var y=n("mrSG"),S=n("XNiG"),O=n("1G5W"),C=n("cgZG"),w=n("0IaG"),T=n("bTqV");function M(t,e){if(1&t&&(c.Tb(0,"mat-option",7),c.Gc(1),c.gc(2,"translate"),c.Sb()),2&t){const t=e.$implicit,n=c.fc();c.kc("value",t.number),c.Bb(1),c.Jc(" No.",t.number+1," - ",c.hc(2,3,n.getScriptName(t))," ")}}let _=(()=>{class t{constructor(t,e){this.data=t,this._dialogRef=e,this.result=0,this.result=t.code}ngOnInit(){}confirm(){const{result:t}=this,{scripts:e}=this.data,n=e.find(e=>e.number===t);this._dialogRef.close(n)}getScriptName(t){return""===t.values[0]?"\u672a\u547d\u540d":t.values[0]}}return t.\u0275fac=function(e){return new(e||t)(c.Nb(w.a),c.Nb(w.g))},t.\u0275cmp=c.Hb({type:t,selectors:[["ng-component"]],decls:14,vars:11,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["mat-dialog-actions",""],["mat-button","","matDialogClose",""],["mat-button","","cdkFocusInitial","",3,"click"],[3,"value"]],template:function(t,e){1&t&&(c.Tb(0,"h1",0),c.Gc(1),c.gc(2,"translate"),c.Sb(),c.Tb(3,"div",1),c.Tb(4,"mat-form-field"),c.Tb(5,"mat-select",2),c.bc("ngModelChange",function(t){return e.result=t}),c.Ec(6,M,3,5,"mat-option",3),c.Sb(),c.Sb(),c.Sb(),c.Tb(7,"div",4),c.Tb(8,"button",5),c.Gc(9),c.gc(10,"translate"),c.Sb(),c.Tb(11,"button",6),c.bc("click",function(){return e.confirm()}),c.Gc(12),c.gc(13,"translate"),c.Sb(),c.Sb()),2&t&&(c.Bb(1),c.Hc(c.hc(2,5,"WARN.IMPORT_SCRIPT")),c.Bb(4),c.kc("ngModel",e.result),c.Bb(1),c.kc("ngForOf",null==e.data?null:e.data.scripts),c.Bb(3),c.Hc(c.hc(10,7,"COMMON.CANCEL")),c.Bb(3),c.Ic(" ",c.hc(13,9,"COMMON.CONFIRM")," "))},directives:[w.h,w.e,p.b,b.a,g.l,g.n,d.j,w.c,T.a,w.d,m.l],pipes:[l.c],styles:[""]}),t})();var k=n("8SIa"),P=n("jMnz"),I=n("tk/3");let G=(()=>{class t{constructor(t,e){this.api=t,this.http=e}install(){const t=Object.assign({},a.p.record.install);return this.http.post(this.api,t)}uninstall(){const t=Object.assign({},a.p.record.uninstall);return this.http.post(this.api,t)}listener(){const t=Object.assign({},a.p.record.listener);return this.http.post(this.api,t)}}return t.\u0275fac=function(e){return new(e||t)(c.Xb(P.a),c.Xb(I.b))},t.\u0275prov=c.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var N=n("JxTr"),D=n("WTUP"),B=n("dNgK"),L=n("XiUz"),x=n("NFeN");function E(t,e){if(1&t){const t=c.Ub();c.Tb(0,"button",11),c.bc("click",function(){return c.tc(t),c.fc().start()}),c.Tb(1,"mat-icon"),c.Gc(2,"play_arrow"),c.Sb(),c.Sb()}}function j(t,e){if(1&t){const t=c.Ub();c.Tb(0,"button",12),c.bc("click",function(){return c.tc(t),c.fc().stop()}),c.Tb(1,"mat-icon"),c.Gc(2,"stop"),c.Sb(),c.Sb()}}function R(t,e){1&t&&(c.Tb(0,"mat-icon",19),c.Gc(1,"vertical_align_top"),c.Sb())}function F(t,e){1&t&&(c.Tb(0,"mat-icon",20),c.Gc(1,"vertical_align_bottom"),c.Sb())}function U(t,e){1&t&&(c.Rb(0),c.Tb(1,"mat-icon",21),c.Gc(2,"workspaces"),c.Sb(),c.Qb())}function A(t,e){if(1&t&&(c.Rb(0),c.Gc(1),c.Qb()),2&t){const t=c.fc().$implicit;c.Bb(1),c.Ic(" ",t.delay," ms ")}}function H(t,e){if(1&t&&(c.Tb(0,"div",13),c.Tb(1,"div",14),c.Ec(2,R,2,0,"mat-icon",15),c.Ec(3,F,2,0,"mat-icon",16),c.Gc(4),c.Sb(),c.Tb(5,"div",17),c.Ec(6,U,3,0,"ng-container",18),c.Ec(7,A,2,1,"ng-container",18),c.Sb(),c.Sb()),2&t){const t=e.$implicit;c.Bb(2),c.kc("ngIf","Up"===t.action),c.Bb(1),c.kc("ngIf","Down"===t.action),c.Bb(1),c.Ic(" ",null==t?null:t.name," "),c.Bb(2),c.kc("ngIf",-1===t.delay),c.Bb(1),c.kc("ngIf",-1!==t.delay)}}var $=function(t){return t[t.Down=0]="Down",t[t.Up=128]="Up",t}({}),K=function(t){return t[t.Combination=0]="Combination",t[t.General=1]="General",t}({});let J=(()=>{class t{constructor(t,e,n,i,o,c){this.deviceService=t,this.recordService=e,this.scriptService=n,this.loadService=i,this._dialog=o,this._snakeBar=c,this.rowsCounter=0,this.stepCounter=0,this.alive=!1,this.stepList=[],this.destory$=new S.a,this.timer=Date.now(),t.device$.pipe(Object(O.a)(this.destory$)).subscribe(t=>{t&&(this.device=t,n.getScripts(t.session).pipe(Object(O.a)(this.destory$)).subscribe(t=>{this.scripts=t.data}))})}ngOnInit(){this.scrollContainer=document.querySelector(".record-step-wrapper")}ngOnDestroy(){this.alive&&this.stop(),this.destory$.next(),this.destory$.complete()}start(){return Object(y.a)(this,void 0,void 0,function*(){this.rowsCounter=0,this.stepCounter=0,this.stepList=[],this.recordService.install().subscribe(t=>{this.listener(),this.alive=!0})})}stop(){return Object(y.a)(this,void 0,void 0,function*(){this.loadService.loading(),this.alive=!1,yield this.recordService.uninstall().toPromise(),this.stepList.length>0&&(this.stepList[this.stepList.length-1].delay=Number(localStorage.getItem("delay"))||35,this.stepCounter+=2),this._snakeBar.open("Has stopped recording!"),this.loadService.complete()})}listener(){this.stepCounter>=997?this.stop():this.recordService.listener().subscribe(t=>{var e;if(!this.alive)return;if(-1===t.status)return void this.stop();let n=0;if("open"==(localStorage.getItem("isOpenDelay")||"close")?n=Number(localStorage.getItem("delay"))||35:(n=Date.now()-this.timer,this.timer=Date.now()),this.rowsCounter++,(null===(e=this.stepList)||void 0===e?void 0:e.length)>0){const t=n>=256?3:2;this.stepList[this.stepList.length-1].delay=n,this.stepCounter+=t}const i=this.createStep(t,-1);this.stepList.push(i),this.scrollContainer.scrollTop=this.scrollContainer.scrollHeight,this.listener()})}save(){this._dialog.open(C.c,{data:a.g}).afterClosed().subscribe(t=>{if(t){const e=this.createResult();Object(s.h)(e,t.content)}})}openSelectScript(){return Object(y.a)(this,void 0,void 0,function*(){const{device:t,scripts:e}=this;if(t){const{session:n}=t,i=(yield this.scriptService.getScripts(t.session).toPromise()).data.find(t=>1===t.code);this._dialog.open(_,{data:{scripts:e,code:i.code},width:"600px"}).afterClosed().subscribe(e=>Object(y.a)(this,void 0,void 0,function*(){if(e){this.loadService.loading();const o=Object.assign(Object.assign({},e),{code:1});yield this.scriptService.switchScript(n,[o]).toPromise();const c=this.createResult();yield this.scriptService.writeScriptSteps(t.session,c).toPromise(),yield this.scriptService.switchScript(n,[i]).toPromise(),yield this.deviceService.writeConfig(n).toPromise(),this.alive=!1,this.stepList=[],this._snakeBar.open("Save Successful!"),this.loadService.complete()}}))}else this._snakeBar.open("Please connect device!")})}get canAction(){return!this.alive&&this.stepList.length>0}createStep(t,e){const{key_code:n,key_type:i,key_flags:o}=t;let c={name:"1",delay:e,action:"",origin:t};switch(i){case K.General:c.name=this.getNameByOpts(a.r,n);break;case K.Combination:c.name=this.getNameByOpts(a.t,n)}switch(o){case $.Down:c.action="Down";break;case $.Up:c.action="Up"}return c}getNameByOpts(t,e){const n=t.find(t=>t.code===e);return n?n.name:""}createResult(){let t=0;const{stepList:e}=this;return e.map(e=>{const{delay:n}=e,{key_code:i,key_type:o,key_flags:c}=e.origin;let r=[];const a=this.getKeyType(o,c);if(r[0]=this.parseToIns(i,t++,a),n>=256){const e=Math.floor(n/256),i=n%256;r[1]=this.parseToIns(e,t++,"DelayL"),r[2]=this.parseToIns(i,t++,"Delay")}else r[1]=this.parseToIns(n,t++,"Delay");return r}).reduce((t,e)=>t.concat(e))}getKeyType(t,e){return t===K.Combination?e===$.Down?"CombinationDown":"CombinationUp":e===$.Down?"GeneralDown":"GeneralUp"}parseToIns(t,e,n){return{code:{CombinationDown:16,CombinationUp:24,GeneralDown:17,GeneralUp:25,Delay:6,DelayL:5}[n],number:e,values:[t,0,0,0]}}}return t.\u0275fac=function(e){return new(e||t)(c.Nb(k.a),c.Nb(G),c.Nb(N.a),c.Nb(D.a),c.Nb(w.b),c.Nb(B.b))},t.\u0275cmp=c.Hb({type:t,selectors:[["ng-component"]],decls:23,vars:16,consts:[[1,"setting-page-wrapper"],["fxLayout","column",1,"record-action-wrapper"],["mat-fab","","color","primary",3,"click",4,"ngIf"],["color","primary","mat-fab","",3,"click",4,"ngIf"],["color","primary","mat-fab","",3,"disabled","click"],[1,"record-step-container"],[1,"record-step-wrapper"],["fxLayout","row","fxLayoutAlign","space-between center","class","step-wrapper",4,"ngFor","ngForOf"],[1,"hint"],[1,"row-counter"],[1,"step-counter"],["mat-fab","","color","primary",3,"click"],["color","primary","mat-fab","",3,"click"],["fxLayout","row","fxLayoutAlign","space-between center",1,"step-wrapper"],["fxLayout","row","fxLayoutAlign","center center",1,"name"],["class","up",4,"ngIf"],["class","down",4,"ngIf"],[1,"delay"],[4,"ngIf"],[1,"up"],[1,"down"],[1,"wait-icon"]],template:function(t,e){1&t&&(c.Tb(0,"div",0),c.Tb(1,"div",1),c.Ec(2,E,3,0,"button",2),c.Ec(3,j,3,0,"button",3),c.Tb(4,"button",4),c.bc("click",function(){return e.save()}),c.Tb(5,"mat-icon"),c.Gc(6,"download"),c.Sb(),c.Sb(),c.Tb(7,"button",4),c.bc("click",function(){return e.openSelectScript()}),c.Tb(8,"mat-icon"),c.Gc(9,"create"),c.Sb(),c.Sb(),c.Sb(),c.Tb(10,"div",5),c.Tb(11,"div",6),c.Ec(12,H,8,5,"div",7),c.Sb(),c.Tb(13,"div",8),c.Tb(14,"span",9),c.Gc(15),c.gc(16,"translate"),c.Sb(),c.Tb(17,"span",10),c.Gc(18),c.gc(19,"translate"),c.Sb(),c.Tb(20,"span"),c.Gc(21),c.gc(22,"translate"),c.Sb(),c.Sb(),c.Sb(),c.Sb()),2&t&&(c.Bb(2),c.kc("ngIf",!e.alive),c.Bb(1),c.kc("ngIf",e.alive),c.Bb(1),c.kc("disabled",!e.canAction),c.Bb(3),c.kc("disabled",!e.canAction),c.Bb(5),c.kc("ngForOf",e.stepList),c.Bb(3),c.Jc("",c.hc(16,10,"\u884c\u6570"),"\uff1a",e.rowsCounter,""),c.Bb(3),c.Jc("",c.hc(19,12,"\u6b65\u9aa4\u6570"),"\uff1a",e.stepCounter,""),c.Bb(3),c.Ic("( Tip: ",c.hc(22,14,"WARN.MAX_STEP_COUNTER")," )"))},directives:[L.b,d.k,T.a,x.a,d.j,L.a],pipes:[l.c],styles:[".setting-page-wrapper[_ngcontent-%COMP%]{position:relative;display:flex}.setting-page-wrapper[_ngcontent-%COMP%]   .record-action-wrapper[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:5px}.setting-page-wrapper[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{display:flex;place-items:center;line-height:1.75;height:36px;color:#d2d2d2;font-size:12px}.setting-page-wrapper[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-right:1rem}.setting-page-wrapper[_ngcontent-%COMP%]   .record-step-container[_ngcontent-%COMP%]{flex:1;margin:0 1rem}.setting-page-wrapper[_ngcontent-%COMP%]   .record-step-container[_ngcontent-%COMP%]   .record-step-wrapper[_ngcontent-%COMP%]{position:relative;background:#2b3135;border-radius:5px;height:700px;overflow:auto;padding:.5rem}.setting-page-wrapper[_ngcontent-%COMP%]   .step-wrapper[_ngcontent-%COMP%]{height:30px;padding:0 1rem}.setting-page-wrapper[_ngcontent-%COMP%]   .step-wrapper[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:5px}.setting-page-wrapper[_ngcontent-%COMP%]   .step-wrapper[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .mat-icon.down[_ngcontent-%COMP%]{color:red}.setting-page-wrapper[_ngcontent-%COMP%]   .step-wrapper[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .mat-icon.up[_ngcontent-%COMP%]{color:green}.wait-icon[_ngcontent-%COMP%]{transform:rotate(0);animation:rotate 1s linear infinite}@keyframes rotate{0%{transform:rotate(0)}to{transform:rotate(1turn)}}"]}),t})();var X=n("0wH7");const W=[{path:"",component:(()=>{class t{constructor(){this.settingNav=[{name:"SETTING.PREFERENCE",url:"preference",icon:"room_preferences"},{name:"SETTING.RECORD",url:"record",icon:"videocam"}]}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Hb({type:t,selectors:[["ng-component"]],decls:3,vars:1,consts:[[3,"navList"],[1,"setting-container"]],template:function(t,e){1&t&&(c.Ob(0,"sayo-nav",0),c.Tb(1,"div",1),c.Ob(2,"router-outlet"),c.Sb()),2&t&&c.kc("navList",e.settingNav)},directives:[X.a,o.g],styles:[".setting-container[_ngcontent-%COMP%]{padding:3rem 6rem}"]}),t})(),children:[{path:"",redirectTo:"preference"},{path:"preference",component:v},{path:"record",component:J},{path:"about",component:r}]}];let q=(()=>{class t{}return t.\u0275mod=c.Lb({type:t}),t.\u0275inj=c.Kb({factory:function(e){return new(e||t)},imports:[[o.f.forChild(W)],o.f]}),t})(),z=(()=>{class t{}return t.\u0275mod=c.Lb({type:t}),t.\u0275inj=c.Kb({factory:function(e){return new(e||t)},imports:[[i.a,q]]}),t})()}}]);